{
  "hash": "05bcff8bde5f9fc406aa4e2b2c332e7a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Capitulo 6 Diseño longitudinal (ANOVA de medidas repetidas)\"\n---\n\n### Problema\n\n::: callout-important\n**Metodología:** Se realizó un diseño de medidas repetidas en el tiempo, donde la variable independiente fue cada una de las concentraciones del extracto y los testigos; y la variable respuesta fueron: Porcentaje de Inhibición del Área de la Lesió (PIAL) y Porcentaje de Inhibición del Crecimiento Micelial (PICM).\n:::\n\n## Diseño: Tratamiento (factor entre sujetos) x Tiempo (factor intra-sujetos)\n\n## Función para instalar y cargar paquetes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nuse_pkg <- function(pkg){\n  if (!require(pkg, character.only = TRUE)) {\n    install.packages(pkg, dependencies = TRUE)\n    library(pkg, character.only = TRUE)\n  } else {\n    library(pkg, character.only = TRUE)\n  }\n}\n```\n:::\n\n\n## Instalar y cargar todos los paquetes necesarios\n\n\n::: {.cell}\n\n```{.r .cell-code}\nuse_pkg(\"readxl\") \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: readxl\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'readxl' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\nuse_pkg(\"nlme\") \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: nlme\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'nlme' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\nuse_pkg(\"ggplot2\") \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: ggplot2\n```\n\n\n:::\n\n```{.r .cell-code}\nuse_pkg(\"emmeans\") \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: emmeans\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'emmeans' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\nuse_pkg(\"dplyr\") \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: dplyr\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'dplyr' was built under R version 4.3.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:nlme':\n\n    collapse\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nuse_pkg(\"multcomp\") \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: multcomp\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'multcomp' was built under R version 4.3.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: mvtnorm\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'mvtnorm' was built under R version 4.3.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: survival\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'survival' was built under R version 4.3.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: TH.data\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'TH.data' was built under R version 4.3.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: MASS\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'MASS'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:dplyr':\n\n    select\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'TH.data'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:MASS':\n\n    geyser\n```\n\n\n:::\n\n```{.r .cell-code}\nuse_pkg(\"multcompView\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: multcompView\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'multcompView' was built under R version 4.3.3\n```\n\n\n:::\n:::\n\n\n## IMPORTAR DATOS DESDE EXCEL\n\n# Importar datos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nDMRT <- read_excel(\"C:/R-Proyectos/r-para-mi/data/DMRT_Hongos/DMRT.xlsx\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nView(DMRT)\nattach(DMRT)\nnames(DMRT)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Tiempo\"      \"Tratamiento\" \"Repeticion\"  \"Resultado\"  \n```\n\n\n:::\n\n```{.r .cell-code}\nstr(DMRT)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [36 × 4] (S3: tbl_df/tbl/data.frame)\n $ Tiempo     : chr [1:36] \"0 ddi\" \"0 ddi\" \"0 ddi\" \"10 ddi\" ...\n $ Tratamiento: chr [1:36] \"As 100 mg/L Pb\" \"As 100 mg/L Pb\" \"As 100 mg/L Pb\" \"As 100 mg/L Pb\" ...\n $ Repeticion : num [1:36] 1 2 3 1 2 3 1 2 3 1 ...\n $ Resultado  : num [1:36] 0 0 0 4.5 9.7 12.8 63.1 58.3 67.7 82.1 ...\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(DMRT$Resultado)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   3.375  55.725  47.017  78.800  95.650 \n```\n\n\n:::\n:::\n\n\n## Convertir a factores\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDMRT$Tiempo <- as.factor(DMRT$Tiempo) \nDMRT$Tratamiento <- as.factor(DMRT$Tratamiento) \nDMRT$Repeticion <- as.factor(DMRT$Repeticion)\n```\n:::\n\n\n## MODELO MIXTO LINEAL (nlme)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo_mixto <- lme(Resultado ~ Tratamiento * Tiempo, random = ~1 | Repeticion, data = DMRT)\n```\n:::\n\n\n## Resumen del modelo\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(modelo_mixto)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   numDF denDF  F-value p-value\n(Intercept)            1    22 3324.775  <.0001\nTratamiento            2    22  100.341  <.0001\nTiempo                 3    22 1689.034  <.0001\nTratamiento:Tiempo     6    22   41.343  <.0001\n```\n\n\n:::\n:::\n\n\n## COMPARACIONES POST-HOC (EMMEANS + SIDAK)\n\n## Tratamientos dentro de cada tiempo\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Comparaciones Post-Hoc (EMMEANS + SIDAK)\nemmeans_trat_tiempo <- emmeans(modelo_mixto, ~ Tratamiento | Tiempo)\n\ncld_trat_tiempo <- multcomp::cld(\n  emmeans_trat_tiempo,\n  adjust = \"sidak\",   # ajuste Sidak (Tukey no aplica en modelos mixtos)\n  Letters = letters,\n  alpha = 0.05\n)\n\n# Mostrar resultados y gráfico\nprint(cld_trat_tiempo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTiempo = 0 ddi:\n Tratamiento    emmean  SE df lower.CL upper.CL .group\n As 100 mg/L Pb    0.0 1.8  2   -13.64     13.6  a    \n As 150 mg/L Pb    0.0 1.8  2   -13.64     13.6  a    \n As 200 mg/L Pb    0.0 1.8  2   -13.64     13.6  a    \n\nTiempo = 10 ddi:\n Tratamiento    emmean  SE df lower.CL upper.CL .group\n As 100 mg/L Pb    9.0 1.8  2    -4.64     22.6  a    \n As 150 mg/L Pb   30.8 1.8  2    17.13     44.4   b   \n As 200 mg/L Pb   54.9 1.8  2    41.29     68.6    c  \n\nTiempo = 15 ddi:\n Tratamiento    emmean  SE df lower.CL upper.CL .group\n As 150 mg/L Pb   57.3 1.8  2    43.65     70.9  a    \n As 100 mg/L Pb   63.0 1.8  2    49.39     76.7  a    \n As 200 mg/L Pb   75.3 1.8  2    61.64     88.9   b   \n\nTiempo = 20 ddi:\n Tratamiento    emmean  SE df lower.CL upper.CL .group\n As 100 mg/L Pb   86.6 1.8  2    72.92    100.2  a    \n As 150 mg/L Pb   92.9 1.8  2    79.29    106.6   b   \n As 200 mg/L Pb   94.4 1.8  2    80.74    108.0   b   \n\nDegrees-of-freedom method: containment \nConfidence level used: 0.95 \nConf-level adjustment: sidak method for 3 estimates \nP value adjustment: sidak method for 3 tests \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\nplot(cld_trat_tiempo)\n```\n\n::: {.cell-output-display}\n![](Chapter_06_files/figure-docx/unnamed-chunk-8-1.png)\n:::\n:::\n\n\n## Interacción Tratamiento × Tiempo\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemmeans_interaccion <- emmeans(modelo_mixto, ~ Tratamiento * Tiempo)\n\ncld_interaccion <- multcomp::cld(emmeans_interaccion, adjust = \"sidak\", Letters = letters, alpha = 0.05)\n\nprint(cld_interaccion)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Tratamiento    Tiempo emmean  SE df lower.CL upper.CL .group\n As 100 mg/L Pb 0 ddi     0.0 1.8  2   -27.46     27.5  a    \n As 150 mg/L Pb 0 ddi     0.0 1.8  2   -27.46     27.5  a    \n As 200 mg/L Pb 0 ddi     0.0 1.8  2   -27.46     27.5  a    \n As 100 mg/L Pb 10 ddi    9.0 1.8  2   -18.46     36.5  a    \n As 150 mg/L Pb 10 ddi   30.8 1.8  2     3.32     58.2   b   \n As 200 mg/L Pb 10 ddi   54.9 1.8  2    27.47     82.4    c  \n As 150 mg/L Pb 15 ddi   57.3 1.8  2    29.83     84.8    c  \n As 100 mg/L Pb 15 ddi   63.0 1.8  2    35.57     90.5    c  \n As 200 mg/L Pb 15 ddi   75.3 1.8  2    47.82    102.7     d \n As 100 mg/L Pb 20 ddi   86.6 1.8  2    59.10    114.0      e\n As 150 mg/L Pb 20 ddi   92.9 1.8  2    65.47    120.4      e\n As 200 mg/L Pb 20 ddi   94.4 1.8  2    66.92    121.8      e\n\nDegrees-of-freedom method: containment \nConfidence level used: 0.95 \nConf-level adjustment: sidak method for 12 estimates \nP value adjustment: sidak method for 66 tests \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\nplot(cld_interaccion)\n```\n\n::: {.cell-output-display}\n![](Chapter_06_files/figure-docx/unnamed-chunk-9-1.png)\n:::\n:::\n\n",
    "supporting": [
      "Chapter_06_files\\figure-docx"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}