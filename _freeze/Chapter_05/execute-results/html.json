{
  "hash": "050e773fc881b64764fecdf1aea107d7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Capitulo 5 Diseño de Bloques Completamente al Azar (DBCA)\"\n---\n\n### Problema\n\n**Introducción:**\n\n::: callout-caution\nScript: Análisis de un Diseño en Bloques Completamente al Azar (DBCA)\n\nVariables esperadas en la base: \\\ni. Bloque: factor que representa los bloques \\\nii. Tratamiento: factor con los tratamientos a evaluar \\\niii. Respuesta: variable cuantitativa a analizar \\#\n:::\n\n## Cargar Paquetes y librerías necesarias para el analisis de los datos.\n\n## Instalar Paquetes (solo una vez)\n\ninstall.packages(\"readxl\") install.packages(\"car\") install.packages(\"agricolae\") install.packages(\"lmtest\") install.packages(\"ggplot2\")\n\n## Cargar las siguientes librerias\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'readxl' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(car) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: carData\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'carData' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(agricolae)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'agricolae' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(lmtest) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'lmtest' was built under R version 4.3.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: zoo\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'zoo' was built under R version 4.3.2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'zoo'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n:::\n\n\n## Importar datos desde Excel\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nDBCA <- read_excel(\"C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx\")\n```\n:::\n\n\n## Revisar estructura de los datos cargados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nView(DBCA)\nattach(DBCA)\nnames(DBCA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Tratamiento\" \"Bloque\"      \"Resultado\"  \n```\n\n\n:::\n\n```{.r .cell-code}\nstr(DBCA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [120 × 3] (S3: tbl_df/tbl/data.frame)\n $ Tratamiento: chr [1:120] \"NPK Comercial\" \"NPK Comercial\" \"NPK Comercial\" \"NPK Comercial\" ...\n $ Bloque     : chr [1:120] \"A\" \"A\" \"A\" \"A\" ...\n $ Resultado  : num [1:120] 51.5 49.6 51.9 54.6 49.3 ...\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(DBCA$Resultado)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  44.71   52.30   56.76   57.26   61.24   72.39 \n```\n\n\n:::\n:::\n\n\n## Convertir Variables a Factores\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDBCA$Tratamiento <- as.factor(DBCA$Tratamiento) \nDBCA$Bloque <- as.factor(DBCA$Bloque)\n```\n:::\n\n\n## ANOVA para Diseño de Bloques Completamente al Azar -DBCA-\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo <- aov(Resultado~Tratamiento + Bloque, data=DBCA) \nsummary(modelo) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Df Sum Sq Mean Sq F value Pr(>F)    \nTratamiento   3   3602  1200.6 153.749 <2e-16 ***\nBloque        2     11     5.4   0.688  0.505    \nResiduals   114    890     7.8                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n## Verificación de supuestos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- residuals(modelo)\n```\n:::\n\n\n## Normalidad de residuos (Shapiro-Wilk)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(res)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  res\nW = 0.99559, p-value = 0.9725\n```\n\n\n:::\n\n```{.r .cell-code}\nqqnorm(res)\nqqline(res, col = \"red\")\n```\n\n::: {.cell-output-display}\n![](Chapter_05_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(res, main = \"Histograma de residuos\", xlab = \"Residuos\")\n```\n\n::: {.cell-output-display}\n![](Chapter_05_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n:::\n\n\n## Homogeneidad de varianza\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbartlett.test(Resultado ~ Tratamiento, data = DBCA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  Resultado by Tratamiento\nBartlett's K-squared = 7.4355, df = 3, p-value = 0.05924\n```\n\n\n:::\n\n```{.r .cell-code}\ncar::leveneTest(Resultado ~ Tratamiento, data = DBCA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLevene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(>F)\ngroup   3  1.3691 0.2557\n      116               \n```\n\n\n:::\n\n```{.r .cell-code}\nfligner.test(Resultado ~ Tratamiento, data = DBCA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tFligner-Killeen test of homogeneity of variances\n\ndata:  Resultado by Tratamiento\nFligner-Killeen:med chi-squared = 3.3125, df = 3, p-value = 0.3459\n```\n\n\n:::\n:::\n\n\n## Independencia de residuos\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndwtest(modelo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tDurbin-Watson test\n\ndata:  modelo\nDW = 2.042, p-value = 0.4159\nalternative hypothesis: true autocorrelation is greater than 0\n```\n\n\n:::\n:::\n\n\n## Gráficos de diagnóstico del modelo\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Gráficos de diagnóstico del modelo\npar(mfrow = c(1, 2))  # Dividir la ventana en 2 gráficos (1 fila, 2 columnas)\n\nplot(modelo, which = 1)  # Residuos vs valores ajustados (homogeneidad)\nplot(modelo, which = 2)  # QQ-plot (normalidad)\n```\n\n::: {.cell-output-display}\n![](Chapter_05_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))  # Regresar a 1 gráfico por pantalla\n```\n:::\n\n\n## Gráfico de valores ajustados vs residuos estandarizados\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Residuos estandarizados\nresid_est <- rstandard(modelo)\n\n# Valores ajustados predichos\nval_ajus <- fitted(modelo)\n\nplot(val_ajus, resid_est,\n     main = \"Gráfico de valores ajustados vs residuos estandarizados\",\n     xlab = \"Valores ajustados\",\n     ylab = \"Residuos estandarizados\")\nabline(h = 0, col = \"red\", lty = 2)\n```\n\n::: {.cell-output-display}\n![](Chapter_05_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n## Comparaciones múltiples de medias\n\n## Tukey HSD (agrupamiento con letras)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nout_Tukey <-HSD.test(modelo,\"Tratamiento\", group=TRUE, console=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nStudy: modelo ~ \"Tratamiento\"\n\nHSD Test for Resultado \n\nMean Square Error:  7.808829 \n\nTratamiento,  means\n\n                       Resultado      std  r        se   Min   Max     Q25\nNPK + Bioinoculante     54.25933 2.395591 30 0.5101904 49.26 58.09 52.9100\nNPK Comercial           50.29667 2.453096 30 0.5101904 44.71 54.74 48.5975\nOrgánico + NPK          64.78000 3.621806 30 0.5101904 57.14 72.39 62.1700\nOrganico + NPK (50:50)  59.71300 2.488591 30 0.5101904 55.73 65.66 58.2425\n                          Q50     Q75\nNPK + Bioinoculante    54.045 55.9275\nNPK Comercial          50.080 51.8625\nOrgánico + NPK         65.070 66.9650\nOrganico + NPK (50:50) 59.480 61.0025\n\nAlpha: 0.05 ; DF Error: 114 \nCritical Value of Studentized Range: 3.687325 \n\nMinimun Significant Difference: 1.881238 \n\nTreatments with the same letter are not significantly different.\n\n                       Resultado groups\nOrgánico + NPK          64.78000      a\nOrganico + NPK (50:50)  59.71300      b\nNPK + Bioinoculante     54.25933      c\nNPK Comercial           50.29667      d\n```\n\n\n:::\n:::\n\n\n## Comparaciones múltiples con LSD\n\n\n::: {.cell}\n\n```{.r .cell-code}\nout_LSD <- LSD.test(modelo, \"Tratamiento\", group = TRUE, console = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nStudy: modelo ~ \"Tratamiento\"\n\nLSD t Test for Resultado \n\nMean Square Error:  7.808829 \n\nTratamiento,  means and individual ( 95 %) CI\n\n                       Resultado      std  r        se      LCL      UCL   Min\nNPK + Bioinoculante     54.25933 2.395591 30 0.5101904 53.24865 55.27002 49.26\nNPK Comercial           50.29667 2.453096 30 0.5101904 49.28598 51.30735 44.71\nOrgánico + NPK          64.78000 3.621806 30 0.5101904 63.76932 65.79068 57.14\nOrganico + NPK (50:50)  59.71300 2.488591 30 0.5101904 58.70232 60.72368 55.73\n                         Max     Q25    Q50     Q75\nNPK + Bioinoculante    58.09 52.9100 54.045 55.9275\nNPK Comercial          54.74 48.5975 50.080 51.8625\nOrgánico + NPK         72.39 62.1700 65.070 66.9650\nOrganico + NPK (50:50) 65.66 58.2425 59.480 61.0025\n\nAlpha: 0.05 ; DF Error: 114\nCritical Value of t: 1.980992 \n\nleast Significant Difference: 1.429322 \n\nTreatments with the same letter are not significantly different.\n\n                       Resultado groups\nOrgánico + NPK          64.78000      a\nOrganico + NPK (50:50)  59.71300      b\nNPK + Bioinoculante     54.25933      c\nNPK Comercial           50.29667      d\n```\n\n\n:::\n:::\n\n\n## Duncan\n\n\n::: {.cell}\n\n```{.r .cell-code}\nout_Duncan <- duncan.test(modelo, \"Tratamiento\", group = TRUE, console = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nStudy: modelo ~ \"Tratamiento\"\n\nDuncan's new multiple range test\nfor Resultado \n\nMean Square Error:  7.808829 \n\nTratamiento,  means\n\n                       Resultado      std  r        se   Min   Max     Q25\nNPK + Bioinoculante     54.25933 2.395591 30 0.5101904 49.26 58.09 52.9100\nNPK Comercial           50.29667 2.453096 30 0.5101904 44.71 54.74 48.5975\nOrgánico + NPK          64.78000 3.621806 30 0.5101904 57.14 72.39 62.1700\nOrganico + NPK (50:50)  59.71300 2.488591 30 0.5101904 55.73 65.66 58.2425\n                          Q50     Q75\nNPK + Bioinoculante    54.045 55.9275\nNPK Comercial          50.080 51.8625\nOrgánico + NPK         65.070 66.9650\nOrganico + NPK (50:50) 59.480 61.0025\n\nAlpha: 0.05 ; DF Error: 114 \n\nCritical Range\n       2        3        4 \n1.429322 1.504260 1.554074 \n\nMeans with the same letter are not significantly different.\n\n                       Resultado groups\nOrgánico + NPK          64.78000      a\nOrganico + NPK (50:50)  59.71300      b\nNPK + Bioinoculante     54.25933      c\nNPK Comercial           50.29667      d\n```\n\n\n:::\n:::\n\n\n## Bonferroni (usando pairwise.t.test)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nout_Bonf <- pairwise.t.test(DBCA$Resultado, DBCA$Tratamiento, p.adjust.method = \"bonferroni\") \nprint(out_Bonf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPairwise comparisons using t tests with pooled SD \n\ndata:  DBCA$Resultado and DBCA$Tratamiento \n\n                       NPK + Bioinoculante NPK Comercial Orgánico + NPK\nNPK Comercial          1.3e-06             -             -             \nOrgánico + NPK         < 2e-16             < 2e-16       -             \nOrganico + NPK (50:50) 5.6e-11             < 2e-16       8.6e-10       \n\nP value adjustment method: bonferroni \n```\n\n\n:::\n:::\n\n\n## Visualización de resultados\n\n### Caja y Bigote en R base\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(Resultado ~ Tratamiento, data = DBCA, main = \"Gráfico de caja y bigotes por tratamiento\", xlab = \"Tratamiento\", ylab = \"Resultado\", col = rainbow(length(unique(DBCA$Tratamiento))), border = \"black\")\n```\n\n::: {.cell-output-display}\n![](Chapter_05_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n## Boxplot en ggplot2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(DBCA, aes(x = Tratamiento, y = Resultado, fill = Tratamiento)) + geom_boxplot() + theme_minimal() + labs( title = \"Distribución del resultado por tratamiento\", x = \"Tratamiento\", y = \"Resultado\")\n```\n\n::: {.cell-output-display}\n![](Chapter_05_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n",
    "supporting": [
      "Chapter_05_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}