# Interpretación: Los puntos deben seguir de cerca la línea roja.
# --- B. Prueba de Shapiro-Wilk (Opcional, pero complementaria) ---
# shapiro.test(residuos_std)
# Interpretación: Si el valor p > 0.05, no se rechaza la normalidad.
# Homogeneidad de varianzas (Bartlett)
bartlett.test(Resultado ~ Tratamiento, data = DMRT)
# 1. Extraer los valores ajustados (predichos) y los residuos
datos_homocedasticidad <- data.frame(
Valores_Ajustados = fitted(modelo_mixto),
Residuos_Std = residuals(modelo_mixto, type = "normalized")
)
# 2. Generar el gráfico
ggplot(datos_homocedasticidad, aes(x = Valores_Ajustados, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
theme_minimal() +
labs(
title = "Gráfico de Residuos vs. Valores Ajustados (Homocedasticidad)",
x = "Valores Ajustados (Predichos)",
y = "Residuos Estandarizados"
)
# Interpretación: Los puntos deben dispersarse aleatoriamente alrededor de la línea y=0,
# sin formar patrones de embudo o conos.
# 1. Preparar el marco de datos con Residuos, Tiempo e Id
datos_independencia <- data.frame(
Tiempo = modelo_mixto$data$Tiempo,
Id = modelo_mixto$data$Id,
Residuos = residuals(modelo_mixto, type = "normalized")
)
# 2. Generar el gráfico
ggplot(datos_independencia, aes(x = Tiempo, y = Residuos, group = Id)) +
geom_line(alpha = 0.3) +
geom_point(aes(color = Id), show.legend = FALSE) + # Color por Id para diferenciación
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
theme_minimal() +
labs(
title = "Evaluación de la Correlación Temporal de los Residuos",
subtitle = "Si hay patrones, la estructura de correlación debe revisarse",
x = "Tiempo (ddi)",
y = "Residuos Estandarizados"
)
# Interpretación: Si hay un patrón de correlación visible (líneas que siguen una forma
# similar a lo largo del tiempo), el modelo podría necesitar una estructura de
# correlación explícita (p. ej., corAR1) añadida al objeto lme.
ggplot(cld_trat_tiempo, aes(x = Tiempo, y = emmean,
color = Tratamiento, group = Tratamiento)) +
geom_line(size = 1.2) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2) +
geom_text(aes(label = .group), vjust = -1.2,
position = position_dodge(0.2)) +
theme_minimal() +
labs(title = "Comparaciones post-hoc (Sidak) para Tratamiento × Tiempo",
x = "Tiempo",
y = "Bioacumulación de PB (medias ± IC95%)")
# Comparaciones Post-Hoc (EMMEANS + SIDAK)
emmeans_trat_tiempo <- emmeans(modelo_mixto, ~ Tratamiento | Tiempo)
cld_trat_tiempo <- multcomp::cld(
emmeans_trat_tiempo,
adjust = "sidak",   # ajuste Sidak (Tukey no aplica en modelos mixtos)
Letters = letters,
alpha = 0.05
)
# Mostrar resultados y gráfico
print(cld_trat_tiempo)
plot_data <- as.data.frame(cld_trat_tiempo)
ggplot(cld_trat_tiempo, aes(x = Tiempo, y = emmean,
color = Tratamiento, group = Tratamiento)) +
geom_line(size = 1.2) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2) +
geom_text(aes(label = .group), vjust = -1.2,
position = position_dodge(0.2)) +
theme_minimal() +
labs(title = "Comparaciones post-hoc (Sidak) para Tratamiento × Tiempo",
x = "Tiempo",
y = "Bioacumulación de PB (medias ± IC95%)")
# --- CHUNK 1: EMMEANS + CLD ---
emmeans_trat_tiempo <- emmeans(modelo_mixto, ~ Tratamiento | Tiempo)
cld_trat_tiempo <- multcomp::cld(
emmeans_trat_tiempo,
adjust = "sidak",
Letters = letters,
alpha = 0.05
)
# Pasar a data.frame para graficar
plot_data <- as.data.frame(cld_trat_tiempo)
plot_data$Tiempo  <- factor(plot_data$Tiempo)   # por si viene numérico
plot_data$.group  <- trimws(plot_data$.group)   # limpia espacios
# --- CHUNK 2: GRÁFICO ---
pd <- position_dodge(width = 0.45)
ggplot(plot_data, aes(x = Tiempo, y = emmean,
color = Tratamiento, group = Tratamiento)) +
geom_line(position = pd, linewidth = 1.1) +
geom_point(position = pd, size = 3) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, position = pd) +
geom_text(aes(label = .group), vjust = -0.8,
position = pd, show.legend = FALSE) +
theme_minimal() +
labs(title = "Comparaciones post-hoc (Sidak) para Tratamiento × Tiempo",
x = "Tiempo",
y = "Bioacumulación de PB (medias ± IC95%)")
#| label: posthoc-plot
#| echo: false
#| message: false
#| warning: true
# Si no existe, calcula EMMEANS + CLD
if (!exists("cld_trat_tiempo")) {
emmeans_trat_tiempo <- emmeans(modelo_mixto, ~ Tratamiento | Tiempo)
cld_trat_tiempo <- multcomp::cld(
emmeans_trat_tiempo,
adjust = "sidak",
Letters = letters,
alpha = 0.05
)
}
# Convertir a data.frame para ggplot
plot_data <- as.data.frame(cld_trat_tiempo)
# Comprobaciones mínimas (fallan temprano si algo no está)
req_cols <- c("Tiempo","Tratamiento","emmean","lower.CL","upper.CL",".group")
stopifnot(all(req_cols %in% names(plot_data)))
# Limpieza y formatos
plot_data$Tiempo  <- factor(plot_data$Tiempo)
plot_data$.group  <- trimws(plot_data$.group)
# Gráfico
pd <- position_dodge(0.45)
ggplot(plot_data, aes(x = Tiempo, y = emmean,
color = Tratamiento, group = Tratamiento)) +
geom_line(position = pd, linewidth = 1.1) +
geom_point(position = pd, size = 3) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, position = pd) +
geom_text(aes(label = .group), vjust = -0.8,
position = pd, show.legend = FALSE) +
theme_minimal() +
lab
# --- CHUNK 1: EMMEANS + CLD ---
emmeans_trat_tiempo <- emmeans(modelo_mixto, ~ Tratamiento | Tiempo)
cld_trat_tiempo <- multcomp::cld(
emmeans_trat_tiempo,
adjust = "sidak",
Letters = letters,
alpha = 0.05
)
# Pasar a data.frame para graficar
plot_data <- as.data.frame(cld_trat_tiempo)
plot_data$Tiempo  <- factor(plot_data$Tiempo)   # por si viene numérico
plot_data$.group  <- trimws(plot_data$.group)   # limpia espacios
#| label: posthoc-plot
#| echo: false
#| message: false
#| warning: true
# Si no existe, calcula EMMEANS + CLD
if (!exists("cld_trat_tiempo")) {
emmeans_trat_tiempo <- emmeans(modelo_mixto, ~ Tratamiento | Tiempo)
cld_trat_tiempo <- multcomp::cld(
emmeans_trat_tiempo,
adjust = "sidak",
Letters = letters,
alpha = 0.05
)
}
# Convertir a data.frame para ggplot
plot_data <- as.data.frame(cld_trat_tiempo)
# Comprobaciones mínimas (fallan temprano si algo no está)
req_cols <- c("Tiempo","Tratamiento","emmean","lower.CL","upper.CL",".group")
stopifnot(all(req_cols %in% names(plot_data)))
# Limpieza y formatos
plot_data$Tiempo  <- factor(plot_data$Tiempo)
plot_data$.group  <- trimws(plot_data$.group)
# Gráfico
pd <- position_dodge(0.45)
ggplot(plot_data, aes(x = Tiempo, y = emmean,
color = Tratamiento, group = Tratamiento)) +
geom_line(position = pd, linewidth = 1.1) +
geom_point(position = pd, size = 3) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, position = pd) +
geom_text(aes(label = .group), vjust = -0.8,
position = pd, show.legend = FALSE) +
theme_minimal() +
lab
#| label: posthoc-plot
#| echo: false
#| message: false
#| warning: true
# Si no existe, calcula EMMEANS + CLD
if (!exists("cld_trat_tiempo")) {
emmeans_trat_tiempo <- emmeans(modelo_mixto, ~ Tratamiento | Tiempo)
cld_trat_tiempo <- multcomp::cld(
emmeans_trat_tiempo,
adjust = "sidak",
Letters = letters,
alpha = 0.05
)
}
# Convertir a data.frame para ggplot
plot_data <- as.data.frame(cld_trat_tiempo)
# Comprobaciones mínimas (fallan temprano si algo no está)
req_cols <- c("Tiempo","Tratamiento","emmean","lower.CL","upper.CL",".group")
stopifnot(all(req_cols %in% names(plot_data)))
# Limpieza y formatos
plot_data$Tiempo  <- factor(plot_data$Tiempo)
plot_data$.group  <- trimws(plot_data$.group)
# Gráfico
pd <- position_dodge(0.45)
ggplot(plot_data, aes(x = Tiempo, y = emmean,
color = Tratamiento, group = Tratamiento)) +
geom_line(position = pd, linewidth = 1.1) +
geom_point(position = pd, size = 3) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL),
width = 0.2, position = pd) +
geom_text(aes(label = .group), vjust = -0.8,
position = pd, show.legend = FALSE) +
theme_minimal() +
labs(title = "Comparaciones post-hoc (Sidak) para Tratamiento × Tiempo",
x = "Tiempo",
y = "Bioacumulación de PB (medias ± IC95%)")
suppressPackageStartupMessages({
library(readxl)
library(nlme)
library(ggplot2)
library(emmeans)
library(dplyr)
library(multcomp)
library(multcompView)
})
# Cargar la librería necesaria para el modelo (si no está cargada)
# library(nlme)
library(ggplot2)
# 1. Extraer los residuos estandarizados del modelo
residuos_std <- residuals(modelo_mixto, type = "normalized")
# 2. Crear un marco de datos con los residuos estandarizados
datos_qq <- data.frame(
Residuos_Std = residuos_std,
Teoricos = qnorm(ppoints(length(residuos_std)))
)
# 3. Generar el gráfico Q-Q
ggplot(datos_qq, aes(x = Teoricos, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
theme_minimal() +
labs(
title = "Gráfico Q-Q para la Normalidad de los Residuos",
x = "Cuantiles Teóricos Normales",
y = "Residuos Estandarizados del Modelo"
)
# Interpretación: Los puntos deben seguir de cerca la línea roja.
# --- B. Prueba de Shapiro-Wilk (Opcional, pero complementaria) ---
# shapiro.test(residuos_std)
# Interpretación: Si el valor p > 0.05, no se rechaza la normalidad.
plot(residuos_std)
# Cargar la librería necesaria para el modelo (si no está cargada)
# library(nlme)
library(ggplot2)
# 1. Extraer los residuos estandarizados del modelo
residuos_std <- residuals(modelo_mixto, type = "normalized")
# 2. Crear un marco de datos con los residuos estandarizados
datos_qq <- data.frame(
Residuos_Std = residuos_std,
Teoricos = qnorm(ppoints(length(residuos_std)))
)
# 3. Generar el gráfico Q-Q
ggplot(datos_qq, aes(x = Teoricos, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
theme_minimal() +
labs(
title = "Gráfico Q-Q para la Normalidad de los Residuos",
x = "Cuantiles Teóricos Normales",
y = "Residuos Estandarizados del Modelo"
)
# Interpretación: Los puntos deben seguir de cerca la línea roja.
# --- B. Prueba de Shapiro-Wilk (Opcional, pero complementaria) ---
# shapiro.test(residuos_std)
# Interpretación: Si el valor p > 0.05, no se rechaza la normalidad.
hist(res, main = "Histograma de residuos", xlab = "Residuos")
suppressPackageStartupMessages({
library(readxl)
library(car)
library(agricolae)
library(lmtest)
library(ggplot2)
})
names(DBCA)
str(DBCA)
summary(DBCA$Resultado)
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
View(DBCA)
names(DBCA)
str(DBCA)
summary(DBCA$Resultado)
DBCA$Tratamiento <- as.factor(DBCA$Tratamiento)
DBCA$Bloque <- as.factor(DBCA$Bloque)
DBCA$Tratamiento <- as.factor(DBCA$Tratamiento)
DBCA$Bloque <- as.factor(DBCA$Bloque)
### Estructura de la base de datos
suppressPackageStartupMessages({
library(readxl)
library(car)
library(agricolae)
library(lmtest)
library(ggplot2)
})
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
View(DBCA)
names(DBCA)
str(DBCA)
summary(DBCA$Resultado)
DBCA$Tratamiento <- as.factor(DBCA$Tratamiento)
DBCA$Bloque <- as.factor(DBCA$Bloque)
DBCA$Tratamiento <- as.factor(DBCA$Tratamiento)
DBCA$Bloque <- as.factor(DBCA$Bloque)
str (DBCA)
modelo <- aov(Resultado~Tratamiento + Bloque, data=DBCA)
summary(modelo)
res <- residuals(modelo)
shapiro.test(res)
qqnorm(res)
qqline(res, col = "red")
hist(res, main = "Histograma de residuos", xlab = "Residuos")
shapiro.test(res)
qqnorm(res)
qqline(res, col = "red")
hist(res, main = "Histograma de residuos", xlab = "Residuos")
res <- residuals(modelo)
shapiro.test(res)
qqnorm(res)
qqline(res, col = "red")
hist(res, main = "Histograma de residuos", xlab = "Residuos")
bartlett.test(Resultado ~ Tratamiento, data = DBCA)
car::leveneTest(Resultado ~ Tratamiento, data = DBCA)
fligner.test(Resultado ~ Tratamiento, data = DBCA)
qqnorm(res)
qqline(res, col = "red")
hist(res, main = "Histograma de residuos", xlab = "Residuos")
shapiro.test(res)
bartlett.test(Resultado ~ Tratamiento, data = DBCA)
car::leveneTest(Resultado ~ Tratamiento, data = DBCA)
fligner.test(Resultado ~ Tratamiento, data = DBCA)
bartlett.test(Resultado ~ Tratamiento, data = DBCA)
car::leveneTest(Resultado ~ Tratamiento, data = DBCA)
fligner.test(Resultado ~ Tratamiento, data = DBCA)
# 1. Extraer los valores ajustados (predichos) y los residuos
datos_homocedasticidad <- data.frame(
Valores_Ajustados = fitted(modelo_mixto),
Residuos_Std = residuals(modelo_mixto, type = "normalized")
)
# 2. Generar el gráfico
ggplot(datos_homocedasticidad, aes(x = Valores_Ajustados, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
theme_minimal() +
labs(
title = "Gráfico de Residuos vs. Valores Ajustados (Homocedasticidad)",
x = "Valores Ajustados (Predichos)",
y = "Residuos Estandarizados"
)
# Interpretación: Los puntos deben dispersarse aleatoriamente alrededor de la línea y=0,
# sin formar patrones de embudo o conos.
# 2. Gráfico de residuos vs valores ajustados
ggplot(datos_homocedasticidad, aes(x = Valores_Ajustados, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
theme_minimal() +
labs(
title = "Gráfico de Residuos vs. Valores Ajustados (Homogeneidad de Varianzas)",
x = "Valores ajustados (predichos)",
y = "Residuos estandarizados"
)
# Interpretación:
# Los puntos deben dispersarse aleatoriamente alrededor de la línea y = 0,
# sin formar patrones de embudo o cono, lo cual indicaría homocedasticidad.
# 1. Extraer los valores ajustados (predichos) y los residuos
datos_homocedasticidad <- data.frame(
Valores_Ajustados = fitted(modelo_mixto),
Residuos_Std = residuals(modelo_mixto, type = "normalized")
)
# 2. Generar el gráfico
ggplot(datos_homocedasticidad, aes(x = Valores_Ajustados, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
theme_minimal() +
labs(
title = "Gráfico de Residuos vs. Valores Ajustados (Homocedasticidad)",
x = "Valores Ajustados (Predichos)",
y = "Residuos Estandarizados"
)
# Interpretación: Los puntos deben dispersarse aleatoriamente alrededor de la línea y=0,
# sin formar patrones de embudo o conos.
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
View(DBCA)
names(DBCA)
str(DBCA)
summary(DBCA$Resultado)
DBCA$Tratamiento <- as.factor(DBCA$Tratamiento)
DBCA$Bloque <- as.factor(DBCA$Bloque)
str (DBCA)
install.packages("readxl")
install.packages("car")
install.packages("agricolae")
install.packages("lmtest")
install.packages("ggplot2")
install.packages("ggplot2")
suppressPackageStartupMessages({
library(readxl)
library(car)
library(agricolae)
library(lmtest)
library(ggplot2)
})
suppressPackageStartupMessages({
library(readxl)
library(car)
library(agricolae)
library(lmtest)
library(ggplot2)
})
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
View(DBCA)
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
install.packages("readxl")
install.packages("car")
install.packages("agricolae")
install.packages("lmtest")
install.packages("ggplot2")
install.packages("car")
install.packages("readxl")
install.packages("car")
install.packages("agricolae")
install.packages("lmtest")
install.packages("ggplot2")
install.packages("gtable")
suppressPackageStartupMessages({
library(readxl)
library(car)
library(agricolae)
library(lmtest)
library(ggplot2)
})
install.packages("ggplot2")
suppressPackageStartupMessages({
library(readxl)
library(car)
library(agricolae)
library(lmtest)
library(ggplot2)
})
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
names(DBCA)
names(DBCA)
str(DBCA)
DBCA$Tratamiento <- as.factor(DBCA$Tratamiento)
DBCA$Bloque <- as.factor(DBCA$Bloque)
str (DBCA)
modeloDBCA <- aov(Resultado~Tratamiento + Bloque, data=DBCA)
summary(modelo)
res <- residuals(modeloDBCA)
shapiro.test(res)
qqnorm(res)
qqline(res, col = "red")
hist(res, main = "Histograma de residuos", xlab = "Residuos")
bartlett.test(Resultado ~ Tratamiento, data = DBCA)
car::leveneTest(Resultado ~ Tratamiento, data = DBCA)
fligner.test(Resultado ~ Tratamiento, data = DBCA)
# 2. Gráfico de residuos vs valores ajustados
ggplot(datos_homocedasticidad, aes(x = Valores_Ajustados, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
theme_minimal() +
labs(
title = "Gráfico de Residuos vs. Valores Ajustados (Homogeneidad de Varianzas)",
x = "Valores ajustados (predichos)",
y = "Residuos estandarizados"
)
# Verificar e instalar ggplot2 si no está disponible
if (!require(ggplot2)) {
install.packages("ggplot2")
library(ggplot2)
} else {
library(ggplot2)
}
# Verificar e instalar ggplot2 si no está disponible
if (!require(ggplot2)) {
install.packages("ggplot2")
library(ggplot2)
} else {
library(ggplot2)
}
# Verificar e instalar ggplot2 si no está disponible
if (!require(ggplot2)) {
install.packages("ggplot2")
library(ggplot2)
} else {
library(ggplot2)
}
install.packages("ggplot2")
library(GGally)
library(ggforce)
