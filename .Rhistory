str(DBCA)
summary(DBCA$Resultado)
DBCA$Tratamiento <- as.factor(DBCA$Tratamiento)
DBCA$Bloque <- as.factor(DBCA$Bloque)
DBCA$Tratamiento <- as.factor(DBCA$Tratamiento)
DBCA$Bloque <- as.factor(DBCA$Bloque)
### Estructura de la base de datos
suppressPackageStartupMessages({
library(readxl)
library(car)
library(agricolae)
library(lmtest)
library(ggplot2)
})
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
View(DBCA)
names(DBCA)
str(DBCA)
summary(DBCA$Resultado)
DBCA$Tratamiento <- as.factor(DBCA$Tratamiento)
DBCA$Bloque <- as.factor(DBCA$Bloque)
DBCA$Tratamiento <- as.factor(DBCA$Tratamiento)
DBCA$Bloque <- as.factor(DBCA$Bloque)
str (DBCA)
modelo <- aov(Resultado~Tratamiento + Bloque, data=DBCA)
summary(modelo)
res <- residuals(modelo)
shapiro.test(res)
qqnorm(res)
qqline(res, col = "red")
hist(res, main = "Histograma de residuos", xlab = "Residuos")
shapiro.test(res)
qqnorm(res)
qqline(res, col = "red")
hist(res, main = "Histograma de residuos", xlab = "Residuos")
res <- residuals(modelo)
shapiro.test(res)
qqnorm(res)
qqline(res, col = "red")
hist(res, main = "Histograma de residuos", xlab = "Residuos")
bartlett.test(Resultado ~ Tratamiento, data = DBCA)
car::leveneTest(Resultado ~ Tratamiento, data = DBCA)
fligner.test(Resultado ~ Tratamiento, data = DBCA)
qqnorm(res)
qqline(res, col = "red")
hist(res, main = "Histograma de residuos", xlab = "Residuos")
shapiro.test(res)
bartlett.test(Resultado ~ Tratamiento, data = DBCA)
car::leveneTest(Resultado ~ Tratamiento, data = DBCA)
fligner.test(Resultado ~ Tratamiento, data = DBCA)
bartlett.test(Resultado ~ Tratamiento, data = DBCA)
car::leveneTest(Resultado ~ Tratamiento, data = DBCA)
fligner.test(Resultado ~ Tratamiento, data = DBCA)
# 1. Extraer los valores ajustados (predichos) y los residuos
datos_homocedasticidad <- data.frame(
Valores_Ajustados = fitted(modelo_mixto),
Residuos_Std = residuals(modelo_mixto, type = "normalized")
)
# 2. Generar el gráfico
ggplot(datos_homocedasticidad, aes(x = Valores_Ajustados, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
theme_minimal() +
labs(
title = "Gráfico de Residuos vs. Valores Ajustados (Homocedasticidad)",
x = "Valores Ajustados (Predichos)",
y = "Residuos Estandarizados"
)
# Interpretación: Los puntos deben dispersarse aleatoriamente alrededor de la línea y=0,
# sin formar patrones de embudo o conos.
# 2. Gráfico de residuos vs valores ajustados
ggplot(datos_homocedasticidad, aes(x = Valores_Ajustados, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
theme_minimal() +
labs(
title = "Gráfico de Residuos vs. Valores Ajustados (Homogeneidad de Varianzas)",
x = "Valores ajustados (predichos)",
y = "Residuos estandarizados"
)
# Interpretación:
# Los puntos deben dispersarse aleatoriamente alrededor de la línea y = 0,
# sin formar patrones de embudo o cono, lo cual indicaría homocedasticidad.
# 1. Extraer los valores ajustados (predichos) y los residuos
datos_homocedasticidad <- data.frame(
Valores_Ajustados = fitted(modelo_mixto),
Residuos_Std = residuals(modelo_mixto, type = "normalized")
)
# 2. Generar el gráfico
ggplot(datos_homocedasticidad, aes(x = Valores_Ajustados, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
theme_minimal() +
labs(
title = "Gráfico de Residuos vs. Valores Ajustados (Homocedasticidad)",
x = "Valores Ajustados (Predichos)",
y = "Residuos Estandarizados"
)
# Interpretación: Los puntos deben dispersarse aleatoriamente alrededor de la línea y=0,
# sin formar patrones de embudo o conos.
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
View(DBCA)
names(DBCA)
str(DBCA)
summary(DBCA$Resultado)
DBCA$Tratamiento <- as.factor(DBCA$Tratamiento)
DBCA$Bloque <- as.factor(DBCA$Bloque)
str (DBCA)
install.packages("readxl")
install.packages("car")
install.packages("agricolae")
install.packages("lmtest")
install.packages("ggplot2")
install.packages("ggplot2")
suppressPackageStartupMessages({
library(readxl)
library(car)
library(agricolae)
library(lmtest)
library(ggplot2)
})
suppressPackageStartupMessages({
library(readxl)
library(car)
library(agricolae)
library(lmtest)
library(ggplot2)
})
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
View(DBCA)
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
install.packages("readxl")
install.packages("car")
install.packages("agricolae")
install.packages("lmtest")
install.packages("ggplot2")
install.packages("car")
install.packages("readxl")
install.packages("car")
install.packages("agricolae")
install.packages("lmtest")
install.packages("ggplot2")
install.packages("gtable")
suppressPackageStartupMessages({
library(readxl)
library(car)
library(agricolae)
library(lmtest)
library(ggplot2)
})
install.packages("ggplot2")
suppressPackageStartupMessages({
library(readxl)
library(car)
library(agricolae)
library(lmtest)
library(ggplot2)
})
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
names(DBCA)
names(DBCA)
str(DBCA)
DBCA$Tratamiento <- as.factor(DBCA$Tratamiento)
DBCA$Bloque <- as.factor(DBCA$Bloque)
str (DBCA)
modeloDBCA <- aov(Resultado~Tratamiento + Bloque, data=DBCA)
summary(modelo)
res <- residuals(modeloDBCA)
shapiro.test(res)
qqnorm(res)
qqline(res, col = "red")
hist(res, main = "Histograma de residuos", xlab = "Residuos")
bartlett.test(Resultado ~ Tratamiento, data = DBCA)
car::leveneTest(Resultado ~ Tratamiento, data = DBCA)
fligner.test(Resultado ~ Tratamiento, data = DBCA)
# 2. Gráfico de residuos vs valores ajustados
ggplot(datos_homocedasticidad, aes(x = Valores_Ajustados, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
theme_minimal() +
labs(
title = "Gráfico de Residuos vs. Valores Ajustados (Homogeneidad de Varianzas)",
x = "Valores ajustados (predichos)",
y = "Residuos estandarizados"
)
# Verificar e instalar ggplot2 si no está disponible
if (!require(ggplot2)) {
install.packages("ggplot2")
library(ggplot2)
} else {
library(ggplot2)
}
# Verificar e instalar ggplot2 si no está disponible
if (!require(ggplot2)) {
install.packages("ggplot2")
library(ggplot2)
} else {
library(ggplot2)
}
# Verificar e instalar ggplot2 si no está disponible
if (!require(ggplot2)) {
install.packages("ggplot2")
library(ggplot2)
} else {
library(ggplot2)
}
install.packages("ggplot2")
library(GGally)
library(ggforce)
remove.packages("ggplot2")
install.packages("ggplot2")
library(ggplot2)
remove.packages("ggplot2")
install.packages("ggplot2")
library(ggplot2)
install.packages("ggplot2.utils")
install.packages("ggplot2")
library (ggplot2)
install.packages("ggplot2")
install.packages("ggplot2")
library(ggplot2)
library(readxl)
DBCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx")
names(DBCA)
str(DBCA)
summary(DBCA$Resultado)
DBCA$Tratamiento <- as.factor(DBCA$Tratamiento)
DBCA$Bloque <- as.factor(DBCA$Bloque)
str (DBCA)
modeloDBCA <- aov(Resultado~Tratamiento + Bloque, data=DBCA)
summary(modelo)
modeloDBCA <- aov(Resultado~Tratamiento + Bloque, data=DBCA)
summary(modeloDBCA)
res <- residuals(modeloDBCA)
shapiro.test(res)
qqnorm(res)
qqline(res, col = "red")
hist(res, main = "Histograma de residuos", xlab = "Residuos")
bartlett.test(Resultado ~ Tratamiento, data = DBCA)
car::leveneTest(Resultado ~ Tratamiento, data = DBCA)
fligner.test(Resultado ~ Tratamiento, data = DBCA)
# Verificar e instalar ggplot2 si no está disponible
if (!require(ggplot2)) {
install.packages("ggplot2")
library(ggplot2)
} else {
library(ggplot2)
}
# Luego ejecuta tu gráfico
ggplot(datos_homocedasticidad, aes(x = Valores_Ajustados, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
theme_minimal() +
labs(
title = "Gráfico de Residuos vs. Valores Ajustados (Homogeneidad de Varianzas)",
x = "Valores ajustados (predichos)",
y = "Residuos estandarizados"
)
# 2. Gráfico de residuos vs valores ajustados
ggplot(datos_homocedasticidad, aes(x = Valores_Ajustados, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
theme_minimal() +
labs(
title = "Gráfico de Residuos vs. Valores Ajustados (Homogeneidad de Varianzas)",
x = "Valores ajustados (predichos)",
y = "Residuos estandarizados"
)
# Interpretación:
# Los puntos deben dispersarse aleatoriamente alrededor de la línea y = 0,
# sin formar patrones de embudo o cono, lo cual indicaría homocedasticidad.
# 1. Extraer valores ajustados y residuos del modelo DBCA
datos_homocedasticidad <- data.frame(
Valores_Ajustados = fitted(modeloDBCA),     # valores predichos del modelo
Residuos_Std = rstandard(modeloDBCA)        # residuos estandarizados
)
# 2. Gráfico de residuos vs valores ajustados
ggplot(datos_homocedasticidad, aes(x = Valores_Ajustados, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
theme_minimal() +
labs(
title = "Gráfico de Residuos vs. Valores Ajustados (Homogeneidad de Varianzas)",
x = "Valores ajustados (predichos)",
y = "Residuos estandarizados"
)
# Interpretación:
# Los puntos deben dispersarse aleatoriamente alrededor de y = 0
# sin formar patrones o conos, indicando homogeneidad de varianzas.
dwtest(modelo)
# Gráficos de diagnóstico del modelo
par(mfrow = c(1, 2))  # Dividir la ventana en 2 gráficos (1 fila, 2 columnas)
plot(modeloDBCA, which = 1)  # Residuos vs valores ajustados (homogeneidad)
plot(modeloDBCA, which = 2)  # QQ-plot (normalidad)
par(mfrow = c(1, 1))  # Regresar a 1 gráfico por pantalla
# Residuos estandarizados
resid_est <- rstandard(modelo)
# Valores ajustados predichos
val_ajus <- fitted(modelo)
plot(val_ajus, resid_est,
main = "Gráfico de valores ajustados vs residuos estandarizados",
xlab = "Valores ajustados",
ylab = "Residuos estandarizados")
abline(h = 0, col = "red", lty = 2)
dwtest(modelo)
dwtest(modeloDBCA)
suppressPackageStartupMessages({
library(readxl)
library(car)
library(agricolae)
library(lmtest)
library(ggplot2)
})
dwtest(modeloDBCA)
bartlett.test(Resultado ~ Tratamiento, data = DBCA)
car::leveneTest(Resultado ~ Tratamiento, data = DBCA)
fligner.test(Resultado ~ Tratamiento, data = DBCA)
dwtest(modeloDBCA)
dwtest(modeloDBCA)
dwtest(modeloDBCA)
print(dwtest(modeloDBCA))
dwtest(modeloDBCA)
print(dwtest(modeloDBCA))
dwtest(modeloDBCA)
print(dwtest(modeloDBCA))
dwtest(modeloDBCA)
out_Tukey <-HSD.test(modelo,"Tratamiento", group=TRUE, console=TRUE)
out_LSD <- LSD.test(modelo, "Tratamiento", group = TRUE, console = TRUE)
out_Duncan <- duncan.test(modelo, "Tratamiento", group = TRUE, console = TRUE)
out_Bonf <- pairwise.t.test(DBCA$Resultado, DBCA$Tratamiento, p.adjust.method = "bonferroni")
print(out_Bonf)
boxplot(Resultado ~ Tratamiento, data = DBCA, main = "Gráfico de caja y bigotes por tratamiento", xlab = "Tratamiento", ylab = "Resultado", col = rainbow(length(unique(DBCA$Tratamiento))), border = "black")
ggplot(DBCA, aes(x = Tratamiento, y = Resultado, fill = Tratamiento)) + geom_boxplot() + theme_minimal() + labs( title = "Distribución del resultado por tratamiento", x = "Tratamiento", y = "Resultado")
plot(TukeyHSD(Anova))
library(readxl)
DCA <- read_excel("C:/R-Proyectos/r-para-mi/data/CA_Penicillium/dca.xlsx")
library(readxl)
DCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DCA_Penicillium/dca.xlsx")
View(DCA)
attach(DCA)
names(DCA)
str(DCA)
summary(DCA$Resultado)
summary(DCA$Resultado)
str(DCA)
names(DCA)
library(readxl)
DCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DCA_Penicillium/dca.xlsx")
View(DCA)
names(DCA)
Anova<-aov(Resultado~Tratamiento, data=DCA)
summary(Anova)
modelo=lm(Resultado~(Tratamiento))
summary(modelo)
library(ggplot2)
DCA$Treatamiento<-factor(DCA$Tratamiento) #transformamos una variable númerica en un factor categórico
ggplot(DCA, aes(x = Tratamiento, y = Resultado, fill=Tratamiento)) +
geom_boxplot()
head(DCA)
View(DCA)
library(readxl)
DCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DCA_Penicillium/dca.xlsx")
View(DCA)
str(DCA)
summary(DCA$Resultado)
DCA$Tratamiento <- as.factor(DCA$Tratamiento)
DCA$Bloque <- as.factor(DCA$Bloque)
# Convertir a factor o numérico según corresponda
DCA$Tratamiento <- as.factor(DCA$Tratamiento)
DCA$Repeticion  <- as.factor(DCA$Repeticion)
DCA$Resultado   <- as.numeric(DCA$Resultado)
modeloDCA <- aov(Resultado ~ Tratamiento + Repeticion, data = DCA)
summary(modeloDCA)
modelo_lm <- lm(Resultado ~ Tratamiento + Repeticion, data = DCA)
summary(modelo_lm)
plot(TukeyHSD(Anova))
library(ggplot2)
DCA$Treatamiento<-factor(DCA$Tratamiento) #transformamos una variable númerica en un factor categórico
ggplot(DCA, aes(x = Tratamiento, y = Resultado, fill=Tratamiento)) +
geom_boxplot()
shapiro.test(residuals(modeloDCA))
library(car) #Grafico de QQ plot
library(carData)
library(dplyr)
library(purrr)
qqPlot(modeloDCA)
bartlett.test(Resultado~Tratamiento, data=DCA)
library(agricolae)
Grupos <- LSD.test(y = modeloDCA, trt = "Tratamiento", group = T, console = T)
Grupos<- LSD.test(y = modeloDCA, trt = "Tratamiento", group = F, console = T)
TukeyHSD(modeloDCA)
plot(TukeyHSD(modeloDCA))
scheffe.test(modeloDCA, "Tratamiento",console=TRUE)
library(agricolae)
# Prueba de Tukey HSD
HSD.test(modelo_DCA, "Tratamiento", group = TRUE, console = TRUE)
library(agricolae)
# Prueba de Tukey HSD
HSD.test(modeloDCA, "Tratamiento", group = TRUE, console = TRUE)
library(ggplot2)
DCA$Treatamiento<-factor(DCA$Tratamiento) #transformamos una variable númerica en un factor categórico
ggplot(DCA, aes(x = Tratamiento, y = Resultado, fill=Tratamiento)) +
geom_boxplot()
suppressPackageStartupMessages({
library(readxl)
library(dplyr)
library(stringr)
library(ggplot2)
library(car)
library(lmtest)
library(agricolae)
library(multcomp)
library(emmeans)
library(multcompView)
})
# Convertir a factor o numérico según corresponda
DCA$Tratamiento <- as.factor(DCA$Tratamiento)
DCA$Repeticion  <- as.factor(DCA$Repeticion)
DCA$Resultado   <- as.numeric(DCA$Resultado)
bartlett.test(Resultado ~ Tratamiento, data = DCA)
leveneTest(Resultado ~ Tratamiento, data = DCA)
fligner.test(Resultado ~ Tratamiento, data = DCA)
dwtest(modeloDCA)
datos_homocedasticidad <- data.frame(
Valores_Ajustados = fitted(modeloDCA),
Residuos_Std = rstandard(modeloDCA)
)
ggplot(datos_homocedasticidad, aes(x = Valores_Ajustados, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
theme_minimal() +
labs(
title = "Gráfico de Residuos vs Valores Ajustados",
x = "Valores ajustados (predichos)",
y = "Residuos estandarizados"
)
library(agricolae)
# Prueba de Tukey HSD
HSD.test(modeloDCA, "Tratamiento", group = TRUE, console = TRUE)
# ---- 11️⃣ Gráfico de medias ± IC ----
library(emmeans)
emm <- emmeans(modeloDCA, ~ Tratamiento)
emm_df <- as.data.frame(emm)
ggplot(emm_df, aes(x = Tratamiento, y = emmean)) +
geom_point(size = 3) +
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.15) +
theme_minimal() +
labs(
title = "Medias ajustadas por tratamiento (±IC 95%)",
x = "Tratamiento",
y = "Media ajustada del resultado"
)
plot(TukeyHSD(modeloDCA))
plot(TukeyHSD(modeloDCA))
library(readxl)
DCA <- read_excel("C:/R-Proyectos/r-para-mi/data/DCA_Penicillium/dca.xlsx")
View(DCA)
head(DCA)
names(DCA)
str(DCA)
summary(DCA$Resultado)
# Convertir a factor o numérico según corresponda
DCA$Tratamiento <- as.factor(DCA$Tratamiento)
DCA$Repeticion  <- as.factor(DCA$Repeticion)
DCA$Resultado   <- as.numeric(DCA$Resultado)
modeloDCA <- aov(Resultado ~ Tratamiento + Repeticion, data = DCA)
summary(modeloDCA)
library(ggplot2)
DCA$Treatamiento<-factor(DCA$Tratamiento) #transformamos una variable númerica en un factor categórico
ggplot(DCA, aes(x = Tratamiento, y = Resultado, fill=Tratamiento)) +
geom_boxplot()
shapiro.test(residuals(modeloDCA))
library(car) #Grafico de QQ plot
library(carData)
library(dplyr)
library(purrr)
qqPlot(modeloDCA)
bartlett.test(Resultado ~ Tratamiento, data = DCA)
leveneTest(Resultado ~ Tratamiento, data = DCA)
fligner.test(Resultado ~ Tratamiento, data = DCA)
datos_homocedasticidad <- data.frame(
Valores_Ajustados = fitted(modeloDCA),
Residuos_Std = rstandard(modeloDCA)
)
ggplot(datos_homocedasticidad, aes(x = Valores_Ajustados, y = Residuos_Std)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
theme_minimal() +
labs(
title = "Gráfico de Residuos vs Valores Ajustados",
x = "Valores ajustados (predichos)",
y = "Residuos estandarizados"
)
dwtest(modeloDCA)
library(agricolae)
Grupos <- LSD.test(y = modeloDCA, trt = "Tratamiento", group = T, console = T)
Grupos<- LSD.test(y = modeloDCA, trt = "Tratamiento", group = F, console = T)
library(agricolae)
# Prueba de Tukey HSD
HSD.test(modeloDCA, "Tratamiento", group = TRUE, console = TRUE)
scheffe.test(modeloDCA, "Tratamiento",console=TRUE)
