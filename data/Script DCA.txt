## =================================================================================
# Diseño Completamente al azar (DCA)
# Proyecto II
# Febrero 12 de 2025
## =================================================================================

# Problema a analizar:El xilano es un polímero que forma parte desde el 20 y hasta el 40% de la biomasa total de las plantas. Las xilanasas son enzimas
hidrolíticas que convierten el xilano en los azúcares que lo constituyen. Debido a esto, las xilanasas son ampliamente utilizadas
en diversos procesos para generar papel y productos químicos, así como en el tratamiento de desechos orgánicos para la generación
de energía. Con el objeto de probar el efecto de diferentes fuentes de azúcar sobre la actividad enzimática de las xilanasas, denotada
por la variable x75, se hizo un experimento utilizando Staphylococcus sp. La unidad experimental fue un matraz Erlenmeyer de
250 ml con 100 ml de medio líquido estándar, que se agitó a 200 rpm y se mantuvo a 37°C con pH inicial de 8.0 durante tres
días. Como se tuvieron dos repeticiones se usaron 12 matraces. La actividad enzimática, que corresponde a la variable respuesta,
se evalúa en Unidades Internacionales (UI) y se determina a un pH de 7.5 
# Fuente de los datos:datos simulados

# Seleccionar el directorio donde tenemos nuestros archivos #
getwd () ## Para ver donde se estan guardando los archivos

#Especifico el directorio que me interesa. 
#NOTA: R lee / (slash o division) y no el de Windows \
setwd ("F:/UDES II-2024/PROYECTO II/DCA")

#Lectura de datos
library(readxl)
DCA <- read_excel("DCA.xlsx")
View(DCA)

attach(DCA)
names(DCA)
str(DCA)
summary(DCA)

#ANOVA
fit<-aov(Xilanasa~Fuente, data=DCA)
summary(fit)

#Grafico Boxplot
boxplot(Xilanasa ~ Fuente, data=DCA)


#Supuestos
#Para verificar la normalidad de los residuos utilizaremos la prueba de Shapiro-Wilks cuyo script es el siguiente:
shapiro.test(residuals(fit))

#Para construir el gr?fico QQ plot y verificar la normalidad, se invoca el paquete "car"

library(car)
#Gr?fico de QQ plot

qqPlot(fit)

#Para verificar el supuesto de homocedasticidad de las varianzas utilizaremos la prueba de Bartlett script es el siguiente:
bartlett.test(Xilanasa~Fuente, data=DCA)

#Pruebas aposteriori
#Utilizaremos la t?cnica LSD (Least Signifficant Difference), para lo cual debemos cargar la libreria agricolae.

library(agricolae)
Grupos<- LSD.test(y = fit, trt = "Fuente", group = T, console = T)

#Otra opcion cuando cambiamos el argumento "group" a F(false), se interpreta a mi parecer de forma m?s sencilla la diferencia entre las medias
Grupos<- LSD.test(y = fit, trt = "Fuente", group = F, console = T)

TukeyHSD(fit)
plot(TukeyHSD(fit))

scheffe.test(fit, "Fuente",console=TRUE)

