<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Capítulo 5.Diseño de Bloques Completamente al Azar (DBCA) – R para Microbiología Industrial: Análisis de Datos y Diseño Experimental con un Enfoque Práctico</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Chapter_06.html" rel="next">
<link href="./Chapter_04.html" rel="prev">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-806c95bdecf85540f7beab145150c922.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Chapter_05.html"><span class="chapter-title">Capítulo 5.Diseño de Bloques Completamente al Azar (DBCA)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R para Microbiología Industrial: Análisis de Datos y Diseño Experimental con un Enfoque Práctico</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/udesanalitica/r-para-mi" title="Ejecutar el código" class="quarto-navigation-tool px-1" aria-label="Ejecutar el código"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Descargar" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Descargar"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./R-para-Microbiología-Industrial--Análisis-de-Datos-y-Diseño-Experimental-con-un-Enfoque-Práctico.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Descargar PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./R-para-Microbiología-Industrial--Análisis-de-Datos-y-Diseño-Experimental-con-un-Enfoque-Práctico.epub">
              <i class="bi bi-journal pe-1"></i>
            Descargar ePub
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">R para MI</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./autores.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Autores</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./agradecimientos.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Agradecimientos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Introducción</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_01.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Capítulo 1. Introducción al software R y la interfaz RStudio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_02.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Capítulo 2. Análisis bibliométrico para la gestión de un diseño experimentos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_03.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Capítulo 3. Generalidades del Diseño Experimental</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_04.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Capítulo 4. Diseño Completamente al Azar (DBCA)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_05.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Capítulo 5.Diseño de Bloques Completamente al Azar (DBCA)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter_06.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Capítulo 6. Uso de Inteligencia Artificial para la simulación de datos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referencias</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#modelo-teórico-para-el-diseño-de-bloques-completamente-al-azar-dbca" id="toc-modelo-teórico-para-el-diseño-de-bloques-completamente-al-azar-dbca" class="nav-link active" data-scroll-target="#modelo-teórico-para-el-diseño-de-bloques-completamente-al-azar-dbca">Modelo teórico para el Diseño de Bloques Completamente al Azar (DBCA)</a></li>
  <li><a href="#análisis-de-varianza" id="toc-análisis-de-varianza" class="nav-link" data-scroll-target="#análisis-de-varianza">Análisis de varianza</a>
  <ul class="collapse">
  <li><a href="#tabla-anova-para-un-diseño-en-bloques-completos-al-azar" id="toc-tabla-anova-para-un-diseño-en-bloques-completos-al-azar" class="nav-link" data-scroll-target="#tabla-anova-para-un-diseño-en-bloques-completos-al-azar">Tabla ANOVA para un diseño en bloques completos al azar</a></li>
  </ul></li>
  <li><a href="#problema" id="toc-problema" class="nav-link" data-scroll-target="#problema">Problema</a></li>
  <li><a href="#estructura-de-la-base-de-datos" id="toc-estructura-de-la-base-de-datos" class="nav-link" data-scroll-target="#estructura-de-la-base-de-datos">Estructura de la base de datos</a>
  <ul class="collapse">
  <li><a href="#descripción-de-las-variables-del-experimento" id="toc-descripción-de-las-variables-del-experimento" class="nav-link" data-scroll-target="#descripción-de-las-variables-del-experimento">Descripción de las variables del experimento</a></li>
  <li><a href="#instalar-paquetes-solo-una-vez" id="toc-instalar-paquetes-solo-una-vez" class="nav-link" data-scroll-target="#instalar-paquetes-solo-una-vez">Instalar Paquetes (solo una vez)</a></li>
  <li><a href="#cargar-las-librerias-necesarias-para-el-análisis" id="toc-cargar-las-librerias-necesarias-para-el-análisis" class="nav-link" data-scroll-target="#cargar-las-librerias-necesarias-para-el-análisis">Cargar las librerias necesarias para el análisis</a></li>
  <li><a href="#importar-datos-desde-excel" id="toc-importar-datos-desde-excel" class="nav-link" data-scroll-target="#importar-datos-desde-excel">Importar datos desde Excel</a></li>
  <li><a href="#exploración-inicial-y-estructura-de-la-base-de-datos" id="toc-exploración-inicial-y-estructura-de-la-base-de-datos" class="nav-link" data-scroll-target="#exploración-inicial-y-estructura-de-la-base-de-datos">Exploración inicial y estructura de la base de datos</a></li>
  <li><a href="#convertir-variables-a-factores" id="toc-convertir-variables-a-factores" class="nav-link" data-scroll-target="#convertir-variables-a-factores">Convertir variables a factores</a></li>
  </ul></li>
  <li><a href="#anova-para-diseño-de-bloques-completamente-al-azar--dbca-" id="toc-anova-para-diseño-de-bloques-completamente-al-azar--dbca-" class="nav-link" data-scroll-target="#anova-para-diseño-de-bloques-completamente-al-azar--dbca-">ANOVA para Diseño de Bloques Completamente al Azar -DBCA-</a></li>
  <li><a href="#verificación-de-supuestos" id="toc-verificación-de-supuestos" class="nav-link" data-scroll-target="#verificación-de-supuestos">Verificación de supuestos</a>
  <ul class="collapse">
  <li><a href="#normalidad-de-residuos-shapiro-wilk" id="toc-normalidad-de-residuos-shapiro-wilk" class="nav-link" data-scroll-target="#normalidad-de-residuos-shapiro-wilk">Normalidad de residuos (Shapiro-Wilk)</a></li>
  <li><a href="#homocedasticidad" id="toc-homocedasticidad" class="nav-link" data-scroll-target="#homocedasticidad">Homocedasticidad</a></li>
  <li><a href="#gráfico-de-residuos-vs.-valores-ajustados" id="toc-gráfico-de-residuos-vs.-valores-ajustados" class="nav-link" data-scroll-target="#gráfico-de-residuos-vs.-valores-ajustados">Gráfico de Residuos vs.&nbsp;Valores Ajustados</a></li>
  <li><a href="#independencia-de-residuos" id="toc-independencia-de-residuos" class="nav-link" data-scroll-target="#independencia-de-residuos">Independencia de residuos</a></li>
  </ul></li>
  <li><a href="#pruebas-aposteriori" id="toc-pruebas-aposteriori" class="nav-link" data-scroll-target="#pruebas-aposteriori"><strong>Pruebas aposteriori</strong></a>
  <ul class="collapse">
  <li><a href="#tukey-hsd-agrupamiento-con-letras" id="toc-tukey-hsd-agrupamiento-con-letras" class="nav-link" data-scroll-target="#tukey-hsd-agrupamiento-con-letras">Tukey HSD (agrupamiento con letras)</a></li>
  <li><a href="#comparaciones-múltiples-con-lsd" id="toc-comparaciones-múltiples-con-lsd" class="nav-link" data-scroll-target="#comparaciones-múltiples-con-lsd">Comparaciones múltiples con LSD</a></li>
  <li><a href="#visualización-de-resultados" id="toc-visualización-de-resultados" class="nav-link" data-scroll-target="#visualización-de-resultados">Visualización de resultados</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/udesanalitica/r-para-mi/edit/main/Chapter_05.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/udesanalitica/r-para-mi/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li><li><a href="https://github.com/udesanalitica/r-para-mi/blob/main/Chapter_05.qmd" class="toc-action"><i class="bi empty"></i>Ver el código</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Capítulo 5.Diseño de Bloques Completamente al Azar (DBCA)</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/4_DBCA/DBCA.PNG" class="img-fluid figure-img"></p>
<figcaption>Nota. Mapa conceptual (p.&nbsp;85). Gutiérrez Pulido, H., y De la Vara Salazar, R. (2012). Análisis y diseño de experimentos (3ª ed.). McGraw-Hill/Interamericana de México. ISBN: 9786071507259.</figcaption>
</figure>
</div>
<p>El mapa conceptual presenta los principales componentes de los <strong>diseños en bloques</strong>, una estrategia experimental usada para controlar la variabilidad mediante la formación de grupos homogéneos llamados <em>bloques</em>. Entre estos diseños se encuentra el <strong>Diseño en Bloques Completos al Azar (DBCA)</strong>, el cual incorpora el <em>efecto de bloque</em> y requiere definir claramente las <strong>hipótesis</strong>, el <strong>modelo estadístico</strong>, así como la <strong>selección y aleatorización</strong> de las unidades experimentales. Su análisis se realiza a través del <strong>ANOVA</strong>, que permite evaluar si los tratamientos difieren más allá de la variación entre bloques.</p>
<p>Otros diseños relacionados incluyen el <strong>diseño en bloques incompletos balanceados</strong> y los diseños <strong>en cuadro latino</strong> y <strong>grecolatino</strong>, los cuales permiten controlar simultáneamente múltiples fuentes de variación. Cada uno de estos diseños exige un procedimiento estructurado que abarca la formulación del modelo, el análisis de varianza correspondiente y la <strong>interpretación</strong> de los resultados.</p>
<section id="modelo-teórico-para-el-diseño-de-bloques-completamente-al-azar-dbca" class="level2">
<h2 class="anchored" data-anchor-id="modelo-teórico-para-el-diseño-de-bloques-completamente-al-azar-dbca">Modelo teórico para el Diseño de Bloques Completamente al Azar (DBCA)</h2>
<p>El <strong>Diseño en Bloques Completos al Azar (DBCA)</strong> se utiliza cuando existe una fuente de variación conocida —denominada <em>bloques</em>— que puede influir en la variable de respuesta. Para controlar esa variabilidad, las unidades experimentales se agrupan en bloques homogéneos, y dentro de cada bloque los tratamientos se asignan aleatoriamente.</p>
<p>El modelo lineal aditivo correspondiente al DBCA se expresa como:</p>
<p><span class="math display">\[
Y_{ij} = \mu + \tau_i + \beta_j + \varepsilon_{ij}
\]</span></p>
<p>donde:</p>
<ul>
<li><span class="math inline">\(Y_{ij}\)</span>: valor observado del tratamiento <span class="math inline">\(i\)</span> en el bloque <span class="math inline">\(j\)</span></li>
<li><span class="math inline">\(\mu\)</span>: media general</li>
<li><span class="math inline">\(\displaystyle \tau_i\)</span>: efecto del tratamiento <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(\displaystyle \beta_j\)</span>: efecto del bloque <span class="math inline">\(j\)</span></li>
<li><span class="math inline">\(\displaystyle \varepsilon_{ij}\)</span>: error aleatorio asociado, con <span class="math inline">\(\displaystyle \varepsilon_{ij} \sim N(0,\sigma^2)\)</span></li>
</ul>
<p>Para ello se formulan las siguientes hipótesis estadísticas:</p>
<p><span class="math display">\[
H_0 : \mu_1 = \mu_2 = \cdots = \mu_k
\]</span></p>
<p><span class="math display">\[
H_A : \mu_i \ne \mu_j \quad \text{para algún } i \ne j
\]</span></p>
<p>Estas hipótesis permiten evaluar si existen diferencias significativas entre los tratamientos más allá de la variabilidad explicada por los bloques.</p>
</section>
<section id="análisis-de-varianza" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-varianza">Análisis de varianza</h2>
<p>De acuerdo con <span class="citation" data-cites="gutierrez2012analisis">(<a href="references.html#ref-gutierrez2012analisis" role="doc-biblioref">Gutiérrez Pulido &amp; Vara Salazar, 2012</a>)</span>, las hipótesis planteadas en las ecuaciones anteriores se evalúan mediante un análisis de varianza de dos vías, debido a que en el DBCA es necesario considerar simultáneamente dos fuentes de variación: los tratamientos y los bloques. La Tabla presenta el formato general del ANOVA correspondiente a un diseño en bloques completos al azar.</p>
<section id="tabla-anova-para-un-diseño-en-bloques-completos-al-azar" class="level3">
<h3 class="anchored" data-anchor-id="tabla-anova-para-un-diseño-en-bloques-completos-al-azar">Tabla ANOVA para un diseño en bloques completos al azar</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Fuente de variabilidad</th>
<th>Suma de cuadrados</th>
<th>Grados de libertad</th>
<th>Cuadrado medio</th>
<th>Estadístico F</th>
<th>Valor-p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tratamientos</td>
<td>SCTRAT</td>
<td><span class="math inline">\(k - 1\)</span></td>
<td>CMTRAT</td>
<td><span class="math inline">\(F_0 = \frac{CM_{TRAT}}{CM_E}\)</span></td>
<td><span class="math inline">\(P(F &gt; F_0)\)</span></td>
</tr>
<tr class="even">
<td>Bloques</td>
<td>SCB</td>
<td><span class="math inline">\(b - 1\)</span></td>
<td>CMB</td>
<td><span class="math inline">\(F_0 = \frac{CM_{B}}{CM_E}\)</span></td>
<td><span class="math inline">\(P(F &gt; F_0)\)</span></td>
</tr>
<tr class="odd">
<td>Error</td>
<td>SCE</td>
<td><span class="math inline">\((k - 1)(b - 1)\)</span></td>
<td>CME</td>
<td>—</td>
<td>—</td>
</tr>
<tr class="even">
<td>Total</td>
<td>SCT</td>
<td><span class="math inline">\(kb - 1\)</span></td>
<td>—</td>
<td>—</td>
<td>—</td>
</tr>
</tbody>
</table>
<p>Nota: SC: Suma de cuadrados, CM: Cuadrado medio.</p>
</section>
</section>
<section id="problema" class="level2">
<h2 class="anchored" data-anchor-id="problema">Problema</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>El <strong>crecimiento de las plantas de frijol (<em>Phaseolus vulgaris</em>)</strong> depende en gran medida de la interacción entre sus raíces y los <strong>microorganismos del suelo</strong>, especialmente los <strong>rizobios</strong>, los cuales establecen una relación simbiótica formando <strong>nódulos radiculares</strong> que facilitan la <strong>fijación biológica de nitrógeno (FBN)</strong>. Este proceso aporta una fuente natural y sostenible de nitrógeno, fundamental para el desarrollo y rendimiento de las plantas.</p>
<p>Sin embargo, el aprovechamiento de esta simbiosis puede verse afectado por <strong>factores edáficos y ambientales</strong> como la <strong>composición del suelo, la disponibilidad de humedad, la temperatura y la luz</strong>, que influyen directamente en la actividad microbiana y en la eficiencia de la FBN.</p>
<p>Por ello, resulta necesario <strong>evaluar la respuesta del frijol frente a diferentes tratamientos de fertilización</strong>, combinando <strong>fuentes químicas y biológicas (bioinoculantes y abonos orgánicos)</strong>, con el fin de identificar estrategias que promuevan un crecimiento óptimo y un manejo más sostenible del cultivo.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/4_DBCA/DBCA_frijol.png" class="img-fluid figure-img" width="326"></p>
<figcaption>Phaseolus vulgaris</figcaption>
</figure>
</div>
<p>Imagen suminitrada por el profesor Christian Chacín. Laboratorio de Cultivos Vegetales UDES (2025).</p>
</div>
</div>
</section>
<section id="estructura-de-la-base-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="estructura-de-la-base-de-datos">Estructura de la base de datos</h2>
<p>El presente experimento se estructuró bajo un <strong>Diseño de Bloques Completamente al Azar (DBCA)</strong> con el objetivo de evaluar el efecto de diferentes tratamientos de fertilización sobre el crecimiento de las plantas de frijol (<em>Phaseolus vulgaris</em>). Este diseño permite controlar la variabilidad asociada a factores ambientales no experimentales mediante la conformación de bloques homogéneos.<br>
En este caso, se consideraron <strong>tres bloques (A, B y C)</strong> que representan unidades experimentales con condiciones similares dentro de cada uno, y se aplicaron <strong>cuatro tratamientos</strong> de fertilización: <strong>NPK Comercial</strong>, <strong>NPK + Bioinoculante</strong>, <strong>Orgánico + NPK (50:50)</strong> y <strong>Orgánico + NPK</strong>.<br>
El parámetro evaluado, denominado <strong>Resultado</strong>, corresponde a una variable cuantitativa continua (por ejemplo, biomasa, concentración de metal o altura), expresada en valores decimales.</p>
<section id="descripción-de-las-variables-del-experimento" class="level3">
<h3 class="anchored" data-anchor-id="descripción-de-las-variables-del-experimento">Descripción de las variables del experimento</h3>
<p>El diseño experimental corresponde a un <strong>Diseño de Bloques Completamente al Azar (DBCA)</strong>, en el cual se evaluaron diferentes tratamientos de fertilización en plantas de frijol (<em>Phaseolus vulgaris</em>).<br>
Los bloques representan unidades experimentales homogéneas, y la variable de respuesta cuantifica el efecto del tratamiento sobre el crecimiento o bioacumulación.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Tipo de variable</th>
<th style="text-align: left;">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Tratamiento</strong></td>
<td style="text-align: left;">Cualitativa nominal</td>
<td style="text-align: left;">Incluye los diferentes niveles de fertilización, como <em>NPK Comercial</em>, <em>NPK + Bioinoculante</em>, <em>Orgánico + NPK (50:50)</em>, entre otros.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Bloque</strong></td>
<td style="text-align: left;">Cualitativa nominal</td>
<td style="text-align: left;">Factor de bloqueo que agrupa las unidades experimentales bajo condiciones similares. Se identifican con letras (A, B, C, …).</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Resultado</strong></td>
<td style="text-align: left;">Cuantitativa continua</td>
<td style="text-align: left;">Variable de respuesta que representa la medición obtenida (por ejemplo: altura, biomasa, concentración de metal, etc.), expresada con valores decimales.</td>
</tr>
</tbody>
</table>
</section>
<section id="instalar-paquetes-solo-una-vez" class="level3">
<h3 class="anchored" data-anchor-id="instalar-paquetes-solo-una-vez">Instalar Paquetes (solo una vez)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("readxl")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("car") </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("agricolae") </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("lmtest") </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("ggplot2")</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("gtable")</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cargar-las-librerias-necesarias-para-el-análisis" class="level3">
<h3 class="anchored" data-anchor-id="cargar-las-librerias-necesarias-para-el-análisis">Cargar las librerias necesarias para el análisis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl) </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car) </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest) </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importar-datos-desde-excel" class="level3">
<h3 class="anchored" data-anchor-id="importar-datos-desde-excel">Importar datos desde Excel</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>DBCA <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"C:/R-Proyectos/r-para-mi/data/DBCA_Frijol/DBCA_frijol.xlsx"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploración-inicial-y-estructura-de-la-base-de-datos" class="level3">
<h3 class="anchored" data-anchor-id="exploración-inicial-y-estructura-de-la-base-de-datos">Exploración inicial y estructura de la base de datos</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(DBCA)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(DBCA)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Tratamiento" "Bloque"      "Resultado"  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(DBCA)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [120 × 3] (S3: tbl_df/tbl/data.frame)
 $ Tratamiento: chr [1:120] "NPK Comercial" "NPK Comercial" "NPK Comercial" "NPK Comercial" ...
 $ Bloque     : chr [1:120] "A" "A" "A" "A" ...
 $ Resultado  : num [1:120] 51.5 49.6 51.9 54.6 49.3 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(DBCA<span class="sc">$</span>Resultado)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  44.71   52.30   56.76   57.26   61.24   72.39 </code></pre>
</div>
</div>
</section>
<section id="convertir-variables-a-factores" class="level3">
<h3 class="anchored" data-anchor-id="convertir-variables-a-factores">Convertir variables a factores</h3>
<p>Para garantizar un análisis correcto bajo el <strong>Diseño de Bloques Completamente al Azar (DBCA)</strong>, las variables <strong>Tratamiento</strong> y <strong>Bloque</strong> se convierten a factores en R. Esta conversión permite que el modelo ANOVA reconozca dichos elementos como variables categóricas y no como valores numéricos, asegurando una interpretación adecuada de los efectos experimentales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>DBCA<span class="sc">$</span>Tratamiento <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(DBCA<span class="sc">$</span>Tratamiento) </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>DBCA<span class="sc">$</span>Bloque <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(DBCA<span class="sc">$</span>Bloque)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span> (DBCA)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [120 × 3] (S3: tbl_df/tbl/data.frame)
 $ Tratamiento: Factor w/ 4 levels "NPK + Bioinoculante",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ Bloque     : Factor w/ 3 levels "A","B","C": 1 1 1 1 1 1 1 1 1 1 ...
 $ Resultado  : num [1:120] 51.5 49.6 51.9 54.6 49.3 ...</code></pre>
</div>
</div>
</section>
</section>
<section id="anova-para-diseño-de-bloques-completamente-al-azar--dbca-" class="level2">
<h2 class="anchored" data-anchor-id="anova-para-diseño-de-bloques-completamente-al-azar--dbca-">ANOVA para Diseño de Bloques Completamente al Azar -DBCA-</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>modeloDBCA <span class="ot">&lt;-</span> <span class="fu">aov</span>(Resultado <span class="sc">~</span> Tratamiento <span class="sc">+</span> Bloque, <span class="at">data =</span> DBCA)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modeloDBCA)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
Tratamiento   3   3602  1200.6 153.749 &lt;2e-16 ***
Bloque        2     11     5.4   0.688  0.505    
Residuals   114    890     7.8                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Interpretación:</strong> Los resultados del Análisis de Varianza (ANOVA) se ajustan a un modelo de Diseño de Bloques Completamente al Azar (DBCA), donde se evaluó el efecto del factor <strong>Tratamiento</strong> sobre una variable de <strong>Resultado</strong>, controlando la variabilidad mediante el factor <strong>Bloque</strong>.</p>
<p>1. <strong>Efecto del Tratamiento</strong>. El análisis indica que el factor Tratamiento es altamente significativo sobre la variable de Resultado. Dado que el valor <span class="math inline">\(\text{p}\)</span> es extremadamente pequeño (denotado por ‘***’), se <strong>rechaza la hipótesis nula</strong> de que no hay diferencias entre las medias de los tratamientos. Esto significa que existe una <strong>diferencia estadísticamente significativa</strong> en el Resultado al menos entre dos de los niveles de Tratamiento. <strong>Grados de Libertad (Df):</strong> 3. <strong>Valor F (F value):</strong> 153.749. <strong>Valor p (</strong><span class="math inline">\(\text{Pr}(&gt;F)\)</span>): <span class="math inline">\(&lt;2 \text{e}-16\)</span> (Menor que <span class="math inline">\(0.001\)</span>)</p>
<p>2. <strong>Efecto del Bloque.</strong> El análisis de la fuente de variación <strong>Bloque</strong> evalúa si el agrupamiento de las unidades experimentales fue efectivo para reducir la variabilidad del error. El valor <span class="math inline">\(\text{p}\)</span> (0.505) es <strong>mayor que el nivel de significancia</strong> comúnmente utilizado (<span class="math inline">\(\alpha = 0.05\)</span>). Por lo tanto, el factor <strong>Bloque no resultó ser significativo</strong>. Esto indica que la variabilidad atribuida a las diferencias entre los Bloques no es mayor que la variabilidad aleatoria, sugiriendo que la inclusión del bloqueo no fue esencial o efectivo en este experimento particular.<strong>Grados de Libertad (Df):</strong> 2. <strong>Valor F (F value):</strong> 0.688. <strong>Valor p (</strong><span class="math inline">\(\text{Pr}(&gt;F)\)</span>): 0.505</p>
<p>3. <strong>Resumen del Modelo.</strong> El factor <strong>Tratamiento ejerce una influencia significativa</strong> en el Resultado. Sin embargo, el factor <strong>Bloque no contribuye significativamente</strong> a explicar la variación del Resultado. Se requiere un análisis <em>post-hoc</em> (como Tukey o Sidak) para determinar cuáles pares específicos de Tratamientos difieren entre sí.</p>
</section>
<section id="verificación-de-supuestos" class="level2">
<h2 class="anchored" data-anchor-id="verificación-de-supuestos">Verificación de supuestos</h2>
<p>El ANOVA requiere cumplir tres supuestos básicos para garantizar la validez de los resultados. Ignorar estos supuestos puede generar conclusiones erróneas:</p>
<ol type="1">
<li><p><strong>Normalidad</strong>, que implica que los datos se aproximen a una distribución normal, evaluada comúnmente con la prueba de <strong>Shapiro–Wilk</strong>.</p></li>
<li><p><strong>Homogeneidad de varianzas (homocedasticidad)</strong>, que supone una variabilidad similar entre los grupos.</p></li>
<li><p><strong>Independencia de las observaciones</strong>, donde los datos de un grupo no deben influir en los de otro.</p></li>
</ol>
<section id="normalidad-de-residuos-shapiro-wilk" class="level3">
<h3 class="anchored" data-anchor-id="normalidad-de-residuos-shapiro-wilk">Normalidad de residuos (Shapiro-Wilk)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">residuals</span>(modeloDBCA)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(res)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  res
W = 0.99559, p-value = 0.9725</code></pre>
</div>
</div>
<p><strong>Interpretación:</strong> La hipótesis nula de <em>Shapiro–Wilk</em> es que los datos provienen de una distribución normal , al tiempo que el&nbsp; p-value = 0.9725 es&nbsp; ≥ que 0.05, no hay evidencia para rechazar la normalidad, es por ello por lo que los residuos pueden considerarse normalmente distribuidos, lo cual respalda el supuesto de normalidad necesario para ANOVA.</p>
<p><strong>Gráfico Q-Q de los residuos estandarizados</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(res)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(res, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter_05_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(res, <span class="at">main =</span> <span class="st">"Histograma de residuos"</span>, <span class="at">xlab =</span> <span class="st">"Residuos"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter_05_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="homocedasticidad" class="level3">
<h3 class="anchored" data-anchor-id="homocedasticidad">Homocedasticidad</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(Resultado <span class="sc">~</span> Tratamiento, <span class="at">data =</span> DBCA)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  Resultado by Tratamiento
Bartlett's K-squared = 7.4355, df = 3, p-value = 0.05924</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(Resultado <span class="sc">~</span> Tratamiento, <span class="at">data =</span> DBCA)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
       Df F value Pr(&gt;F)
group   3  1.3691 0.2557
      116               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fligner.test</span>(Resultado <span class="sc">~</span> Tratamiento, <span class="at">data =</span> DBCA)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fligner-Killeen test of homogeneity of variances

data:  Resultado by Tratamiento
Fligner-Killeen:med chi-squared = 3.3125, df = 3, p-value = 0.3459</code></pre>
</div>
</div>
<p><strong>Interpretación:</strong> La hipótesis nula de <em>Bartlett</em> es que las varianzas entre los grupos son iguales, y como el <em>p-valor</em> =0.059 es ≥ 0.05, no se rechaza la hipótesis nula; no se rechaza la homogeneidad de varianzas, aunque está cerca del umbral. Esto sugiere que los datos cumplen razonablemente el supuesto de homocedasticidad, pero con un margen ajustado.</p>
</section>
<section id="gráfico-de-residuos-vs.-valores-ajustados" class="level3">
<h3 class="anchored" data-anchor-id="gráfico-de-residuos-vs.-valores-ajustados">Gráfico de Residuos vs.&nbsp;Valores Ajustados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Extraer valores ajustados y residuos del modelo DBCA</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>datos_homocedasticidad <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valores_Ajustados =</span> <span class="fu">fitted</span>(modeloDBCA),     <span class="co"># valores predichos del modelo</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Residuos_Std =</span> <span class="fu">rstandard</span>(modeloDBCA)        <span class="co"># residuos estandarizados</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Gráfico de residuos vs valores ajustados</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_homocedasticidad, <span class="fu">aes</span>(<span class="at">x =</span> Valores_Ajustados, <span class="at">y =</span> Residuos_Std)) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gráfico de Residuos vs. Valores Ajustados (Homogeneidad de Varianzas)"</span>,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Valores ajustados (predichos)"</span>,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residuos estandarizados"</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter_05_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretación:</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Los puntos deben dispersarse aleatoriamente alrededor de y = 0</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sin formar patrones o conos, indicando homogeneidad de varianzas.</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Interpretación:</strong> Tanto las pruebas estadísticas (<strong>Bartlett, Levene y Fligner-Killeen</strong>) como el <strong>gráfico de residuos</strong> indican que se cumple el supuesto de <strong>homogeneidad de varianzas</strong> en el modelo DBCA. Por tanto, el análisis de varianza (ANOVA) puede aplicarse de forma válida, ya que la variabilidad dentro de los grupos de tratamiento es similar y no se detectan violaciones importantes de este supuesto.</p>
</section>
<section id="independencia-de-residuos" class="level3">
<h3 class="anchored" data-anchor-id="independencia-de-residuos">Independencia de residuos</h3>
<p>El <strong>Durbin–Watson test</strong> evalúa la <strong>independencia de los residuos</strong>:</p>
<p><strong>Hipótesis nula (H₀):</strong> los residuos son independientes.<br>
<strong>Hipótesis alternativa (H₁):</strong> los residuos están autocorrelacionados.<br>
<br>
Si el <strong>p-value &gt; 0.05</strong>, <strong>no se rechaza H₀</strong>, por lo que <strong>los residuos son independientes</strong> (el supuesto se cumple). Si el <strong>p-value &lt; 0.05</strong>, existe <strong>autocorrelación</strong> y el supuesto no se cumple.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(modeloDBCA)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  modeloDBCA
DW = 2.042, p-value = 0.4159
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<p>Interpretación: Debido a que el <strong>valor</strong> <span class="math inline">\(\text{p}\)</span> (<span class="math inline">\(0.4159\)</span>) es mucho mayor que <span class="math inline">\(0.05\)</span>, <strong>no hay evidencia estadística suficiente para rechazar la hipótesis nula</strong>. Se concluye, por lo tanto, que el supuesto de <strong>independencia de los residuos</strong> se cumple satisfactoriamente en el modelo DBCA. La cercanía del estadístico DW (2.042) al valor ideal de 2.0 refuerza esta conclusión.</p>
</section>
</section>
<section id="pruebas-aposteriori" class="level2">
<h2 class="anchored" data-anchor-id="pruebas-aposteriori"><strong>Pruebas aposteriori</strong></h2>
<p>En el marco del <strong>Diseño de Bloques Completamente al Azar (DBCA)</strong> aplicado al cultivo de frijol, una vez verificados los supuestos de <strong>normalidad</strong> y <strong>homogeneidad de varianzas</strong>, se procede a realizar las <strong>pruebas de comparación múltiple de medias</strong>. Estas pruebas, como las de <strong>Tukey</strong> o <strong>Duncan</strong>, permiten identificar qué tratamientos presentan diferencias significativas en su efecto sobre la altura de las plantas.</p>
<p>El uso del DBCA contribuye a <strong>reducir la variabilidad experimental</strong> al controlar los factores externos mediante el bloqueo, lo que incrementa la <strong>precisión y confiabilidad</strong> de las comparaciones. En consecuencia, las diferencias observadas entre tratamientos reflejan principalmente los <strong>efectos reales de las condiciones aplicadas</strong>, y no la influencia del azar o de fuentes de variación no controladas.</p>
<section id="tukey-hsd-agrupamiento-con-letras" class="level3">
<h3 class="anchored" data-anchor-id="tukey-hsd-agrupamiento-con-letras">Tukey HSD (agrupamiento con letras)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HSD.test</span>(modeloDBCA, <span class="st">"Tratamiento"</span>, <span class="at">group =</span> <span class="cn">TRUE</span>, <span class="at">console =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: modeloDBCA ~ "Tratamiento"

HSD Test for Resultado 

Mean Square Error:  7.808829 

Tratamiento,  means

                       Resultado      std  r        se   Min   Max     Q25
NPK + Bioinoculante     54.25933 2.395591 30 0.5101904 49.26 58.09 52.9100
NPK Comercial           50.29667 2.453096 30 0.5101904 44.71 54.74 48.5975
Orgánico + NPK          64.78000 3.621806 30 0.5101904 57.14 72.39 62.1700
Organico + NPK (50:50)  59.71300 2.488591 30 0.5101904 55.73 65.66 58.2425
                          Q50     Q75
NPK + Bioinoculante    54.045 55.9275
NPK Comercial          50.080 51.8625
Orgánico + NPK         65.070 66.9650
Organico + NPK (50:50) 59.480 61.0025

Alpha: 0.05 ; DF Error: 114 
Critical Value of Studentized Range: 3.687325 

Minimun Significant Difference: 1.881238 

Treatments with the same letter are not significantly different.

                       Resultado groups
Orgánico + NPK          64.78000      a
Organico + NPK (50:50)  59.71300      b
NPK + Bioinoculante     54.25933      c
NPK Comercial           50.29667      d</code></pre>
</div>
</div>
<p><strong>Interpretación:</strong> La prueba de <strong>Tukey HSD</strong>, aplicada al <strong>Diseño de Bloques Completamente al Azar (DBCA)</strong> para la variable <em>altura de las plantas de frijol</em>, indica que el <strong>Tratamiento 4</strong> obtuvo la mayor media (64.78 cm; grupo <em>a</em>), seguido del <strong>Tratamiento 3</strong> (59.71 cm; grupo <em>b</em>), luego el <strong>Tratamiento 2</strong> (54.26 cm; grupo <em>c</em>), y finalmente el <strong>Tratamiento 1</strong> (50.29 cm; grupo <em>d</em>), con la menor media. El valor de la <strong>diferencia mínima significativa (HSD)</strong> fue de <strong>1.88</strong>, más estricto que el obtenido con la prueba <strong>LSD</strong> (1.43). Aun así, los tratamientos mantienen una <strong>separación completa</strong>, sin letras compartidas entre grupos, lo que evidencia que <strong>todas las medias difieren significativamente entre sí</strong> al nivel de confianza del 95 %.</p>
<p>Estos resultados confirman que los tratamientos ejercieron <strong>efectos claramente diferenciados</strong> sobre la altura de las plantas, y que las diferencias observadas <strong>no se deben al azar</strong>. La consistencia entre las pruebas de <strong>LSD y Tukey</strong> respalda la <strong>robustez y confiabilidad del experimento</strong>.</p>
</section>
<section id="comparaciones-múltiples-con-lsd" class="level3">
<h3 class="anchored" data-anchor-id="comparaciones-múltiples-con-lsd">Comparaciones múltiples con LSD</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>out_LSD <span class="ot">&lt;-</span> <span class="fu">LSD.test</span>(modeloDBCA, <span class="st">"Tratamiento"</span>, <span class="at">group =</span> <span class="cn">TRUE</span>, <span class="at">console =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Study: modeloDBCA ~ "Tratamiento"

LSD t Test for Resultado 

Mean Square Error:  7.808829 

Tratamiento,  means and individual ( 95 %) CI

                       Resultado      std  r        se      LCL      UCL   Min
NPK + Bioinoculante     54.25933 2.395591 30 0.5101904 53.24865 55.27002 49.26
NPK Comercial           50.29667 2.453096 30 0.5101904 49.28598 51.30735 44.71
Orgánico + NPK          64.78000 3.621806 30 0.5101904 63.76932 65.79068 57.14
Organico + NPK (50:50)  59.71300 2.488591 30 0.5101904 58.70232 60.72368 55.73
                         Max     Q25    Q50     Q75
NPK + Bioinoculante    58.09 52.9100 54.045 55.9275
NPK Comercial          54.74 48.5975 50.080 51.8625
Orgánico + NPK         72.39 62.1700 65.070 66.9650
Organico + NPK (50:50) 65.66 58.2425 59.480 61.0025

Alpha: 0.05 ; DF Error: 114
Critical Value of t: 1.980992 

least Significant Difference: 1.429322 

Treatments with the same letter are not significantly different.

                       Resultado groups
Orgánico + NPK          64.78000      a
Organico + NPK (50:50)  59.71300      b
NPK + Bioinoculante     54.25933      c
NPK Comercial           50.29667      d</code></pre>
</div>
</div>
<p><strong>Interpretación:</strong> El resultado de la prueba <strong>LSD (Least Significant Difference)</strong> aplicada al <strong>Diseño de Bloques Completamente al Azar (DBCA)</strong> para la variable <em>altura de las plantas de frijol</em> evidencia una clara <strong>separación de medias entre tratamientos</strong>. El <strong>Tratamiento 4</strong> presentó la mayor altura promedio (64.78 cm; grupo <em>a</em>), seguido del <strong>Tratamiento 3</strong> (59.71 cm; grupo <em>b</em>), el <strong>Tratamiento 2</strong> (54.26 cm; grupo <em>c</em>) y finalmente el <strong>Tratamiento 1</strong> (50.29 cm; grupo <em>d</em>), con la menor media. El valor de la <strong>diferencia mínima significativa (LSD)</strong> fue de <strong>1.43</strong>, indicando que cualquier diferencia superior a este umbral es <strong>estadísticamente significativa al 95 % de confianza</strong>. Ninguno de los tratamientos comparte letra, lo que confirma que <strong>todos difieren significativamente entre sí</strong>. Estos resultados respaldan que los tratamientos generaron <strong>efectos distintos y consistentes</strong> sobre la altura de las plantas de frijol, más allá de la variabilidad natural controlada mediante los bloques.</p>
</section>
<section id="visualización-de-resultados" class="level3">
<h3 class="anchored" data-anchor-id="visualización-de-resultados">Visualización de resultados</h3>
<section id="caja-y-bigote-boxplot-en-ggplot2" class="level4">
<h4 class="anchored" data-anchor-id="caja-y-bigote-boxplot-en-ggplot2">Caja y Bigote (Boxplot en ggplot2)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DBCA, <span class="fu">aes</span>(<span class="at">x =</span> Tratamiento, <span class="at">y =</span> Resultado, <span class="at">fill =</span> Tratamiento)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">labs</span>( <span class="at">title =</span> <span class="st">"Distribución del resultado por tratamiento"</span>, <span class="at">x =</span> <span class="st">"Tratamiento"</span>, <span class="at">y =</span> <span class="st">"Resultado"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Chapter_05_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretación:</strong> La gráfica muestra la <strong>distribución de los valores de altura de las plantas de <em>Phaseolus vulgaris</em></strong> bajo cuatro tratamientos de fertilización evaluados mediante un <strong>Diseño de Bloques Completamente al Azar (DBCA)</strong>. Se observa una <strong>tendencia ascendente</strong> en la mediana y en el rango de los resultados desde <strong>NPK Comercial</strong> hasta <strong>Orgánico + NPK</strong>, lo que indica un efecto progresivamente favorable de los tratamientos sobre el crecimiento de las plantas.</p>
<p>El <strong>tratamiento Orgánico + NPK</strong> presenta las mayores alturas promedio, seguido de <strong>Orgánico + NPK (50:50)</strong>, <strong>NPK + Bioinoculante</strong> y finalmente <strong>NPK Comercial</strong>, que registra los valores más bajos. La <strong>variabilidad dentro de cada grupo</strong> se mantiene controlada, aunque se identifica un <strong>valor atípico en el tratamiento Orgánico + NPK (50:50)</strong>, algo común en ensayos biológicos debido a la variación natural entre individuos.</p>
<p>Estos resultados <strong>coinciden con las pruebas de comparación de medias (LSD y Tukey)</strong>, en las que los tratamientos se agrupan en <strong>cuatro categorías estadísticas distintas (a, b, c y d)</strong>, confirmando que las diferencias en altura entre los tratamientos son <strong>estadísticamente significativas</strong> y reflejan <strong>efectos reales</strong> de las condiciones de fertilización aplicadas.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-gutierrez2012analisis" class="csl-entry" role="listitem">
Gutiérrez Pulido, H., &amp; Vara Salazar, R. de la. (2012). <em>An<span>á</span>lisis y dise<span>ñ</span>o de experimentos</em> (3.ª ed.). McGraw-Hill/Interamericana Editores, S.A. de C.V.
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/udesanalitica\.github\.io\/r-para-mi\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter_04.html" class="pagination-link" aria-label="Capítulo 4.
Diseño Completamente al Azar (DBCA)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Capítulo 4. Diseño Completamente al Azar (DBCA)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Chapter_06.html" class="pagination-link" aria-label="Capítulo 6. Uso de Inteligencia Artificial para la simulación de datos">
        <span class="nav-page-text"><span class="chapter-title">Capítulo 6. Uso de Inteligencia Artificial para la simulación de datos</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2025 Autores</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/udesanalitica/r-para-mi/edit/main/Chapter_05.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/udesanalitica/r-para-mi/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li><li><a href="https://github.com/udesanalitica/r-para-mi/blob/main/Chapter_05.qmd" class="toc-action"><i class="bi empty"></i>Ver el código</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Publicado con Quarto y GitHub Pages</p>
</div>
  </div>
</footer>




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>