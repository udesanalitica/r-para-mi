{
  "hash": "6179e5c4ada72876c293a8f4a5b900a0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Parte II: Aplicaciones de R en Microbiología Industrial y Análisis de Datos\"\n---\n\n## 2. Fundamentos del Diseño Experimental (Introducir los principios del diseño experimental OK)\n\n### 2.1 Tipos de diseños experimentales (Expandir sobre los diferentes tipos de diseños OK)\n\n### 2.2 Ejemplos prácticos de diseños experimentales en Microbiología Industrial OK\n\n#### 2.2.1 Diseño completamente al azar OK\n\n::: callout-important\n## Problema\n\nEscibrir los datos del problema y la bibliografci de donde se saco la información.\n:::\n\n### Estructura de la base de datos\n\nLa base de datos utilizada en este análisis corresponde a los resultados de un experimento agrícola que evalúa el comportamiento de cuatro cultivos diferentes bajo condiciones similares de manejo. La tabla contiene tres columnas principales:\n\n| Variable      | Descripción                                                                                         |\n|-----------------------|-------------------------------------------------|\n| `Tratamiento` | Tipo de cultivo evaluado. Incluye cuatro niveles: Arroz, Avena, Cebada y Maíz.                      |\n| `Repetición`  | Número de repetición del tratamiento (del 1 al 4). Permite el análisis estadístico con replicación. |\n| `Resultado`   | Valor numérico correspondiente a la variable respuesta medida (por ejemplo, rendimiento en kg/ha).  |\n\n**Pasos para trabajar con R o RStudio:**\n\nEspecificar el directorio que me interesa donde se encuentra la base de datos.\n\n::: callout-tip\n## Antes e inciar\n\nR lee / (slash o division) y no el de Windows \\\\\n\nEn **R**, `setwd()` es una función que significa **\"set working directory\"** o \"establecer el directorio de trabajo\". Se utiliza para **definir la carpeta predeterminada** en la que R buscará archivos para leer y donde guardará archivos por defecto.\\\n\nPor ejemplo: setwd (\"D:/OneDrive - Universidad de Santander/Material Docente 2025/CodigoR\"\")\n:::\n\n**Lectura de datos**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'readxl' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\nDCA <- read_excel(\"C:/Users/coordinador.analitic/OneDrive - Universidad de Santander/Material_Profesoral_2025/CodigoR/DCA2.xlsx\")\n\nView(DCA)\nattach(DCA)\nnames(DCA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Tratamiento\" \"Repeticion\"  \"Resultado\"  \n```\n\n\n:::\n\n```{.r .cell-code}\nstr(DCA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [16 × 3] (S3: tbl_df/tbl/data.frame)\n $ Tratamiento: chr [1:16] \"Arroz\" \"Arroz\" \"Arroz\" \"Arroz\" ...\n $ Repeticion : num [1:16] 1 2 3 4 1 2 3 4 1 2 ...\n $ Resultado  : num [1:16] 8.76 8.74 8.72 8.72 8.39 ...\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(DCA$Resultado)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  8.341   8.635   8.792   8.775   8.954   9.141 \n```\n\n\n:::\n:::\n\n\n**Análisis de la Varianza - ANOVA**\n\nCuando se desea saber si varios grupos (Ej. tratamientos) presentan diferencias reales en sus promedios, una de las herramientas estadísticas más utilizadas es el Análisis de la Varianza, conocido como ANOVA. Esta técnica permite examinar si los valores medios de tres o más grupos son lo suficientemente distintos como para concluir que no se trata de simples fluctuaciones aleatorias.\n\nEl enfoque de ANOVA se basa en comparar dos tipos de variación: por un lado, l**a variabilidad que se observa entre los distintos grupos**, y por otro, **la variabilidad que existe dentro de cada grupo individual**.\n\nSi al analizar los datos se encuentra que la variación entre los grupos supera notablemente la que ocurre dentro de ellos, es razonable pensar que las diferencias en los promedios reflejan algo más que el azar. En cambio, si la variabilidad interna es más pronunciada, entonces es posible que las diferencias observadas no sean significativas y respondan a variaciones normales del comportamiento de los datos.\n\n**Código de R para ANOVA**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnova<-aov(Resultado~Tratamiento, data=DCA)\nsummary(Anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \nTratamiento  3 1.1794  0.3931   660.4 1.39e-13 ***\nResiduals   12 0.0071  0.0006                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n**Interpretación:** La prueba ANOVA muestra diferencias significativas entre los tratamientos (p \\< 0.001). El valor de F (660.4) indica que la variación entre tratamientos es mucho mayor que la variación dentro de los grupos, lo que sugiere que al menos uno de los tratamientos afecta significativamente el resultado.\n\n**Modelo Lineal**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo=lm(Resultado~(Tratamiento))\nsummary(modelo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Resultado ~ (Tratamiento))\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.038397 -0.016205  0.001983  0.012013  0.040116 \n\nCoefficients:\n                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)        8.73389    0.01220 715.921  < 2e-16 ***\nTratamientoAvena  -0.35848    0.01725 -20.778 8.93e-11 ***\nTratamientoCebada  0.12669    0.01725   7.343 8.94e-06 ***\nTratamientoMaiz    0.39630    0.01725  22.970 2.75e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.0244 on 12 degrees of freedom\nMultiple R-squared:  0.994,\tAdjusted R-squared:  0.9925 \nF-statistic: 660.4 on 3 and 12 DF,  p-value: 1.393e-13\n```\n\n\n:::\n:::\n\n\n**Interpretación:** El modelo lineal confirma que el tratamiento influye significativamente en los resultados (p \\< 0.001). El tratamiento \"Arroz\" actúa como referencia, con una media estimada de 8.73. Comparado con este:\n\n```         \nAvena presenta una media significativamente menor (–0.36, p < 0.001).\n\nCebada muestra un aumento moderado (+0.13, p < 0.001).\n\nMaíz tiene el mayor incremento (+0.40, p < 0.001).\n```\n\nEl modelo explica el 99.4% de la variabilidad en los datos (R² = 0.994), y el error estándar residual es bajo (0.0244), lo que indica un ajuste excelente.\n\n**Gráfico Boxplot**\n\nSe toma el Tratamiento para hacer un boxplot utilizando la variable \"Resultado\", pero primero se transformar en factor la variable Tratamiento:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nDCA$Treatamiento<-factor(DCA$Tratamiento) #transformamos una variable númerica en un factor categórico\nggplot(DCA, aes(x = Tratamiento, y = Resultado, fill=Tratamiento)) + \n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Chapter_02_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n**Interpretación:** Las diferencias en las medianas entre tratamientos son claras y consistentes con los resultados del ANOVA y del modelo lineal, lo que sugiere un efecto significativo del tipo de cultivo sobre la variable resultado.\n\n**Supuestos del diseño**\n\n**Normalidad:** Para verificar la normalidad de los residuos utilizaremos la prueba de Shapiro-Wilks cuyo script es el siguiente:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(residuals(Anova))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(Anova)\nW = 0.97944, p-value = 0.959\n```\n\n\n:::\n:::\n\n\n**Interpretación:** El test de Shapiro-Wilk aplicado a los residuos del modelo ANOVA devuelve un valor de p = 0.959, que es mucho mayor que 0.05. Esto indica que no hay evidencia estadística para rechazar la hipótesis nula de normalidad. Por lo tanto, se concluye que los residuos del modelo siguen una distribución normal, cumpliendo así uno de los supuestos fundamentales del análisis de varianza.\n\n**Gráficos para evaluar la normalidad**\n\nPara construir el gráfico QQ (QQ plot) y evaluar la normalidad de los datos, se utiliza la función correspondiente del paquete car. Si no está instalado previamente, es necesario instalar también el paquete auxiliar carData.\n\nInstalación (si es necesario) install.packages (\"car\") install.packages (\"carData\") install.packages (\"dplyr\") install.packages (\"purrr\")\n\n**Cargar los paquetes (librerias)**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car) #Grafico de QQ plot\nlibrary(carData)\nlibrary(dplyr)\nlibrary(purrr)\n\nqqPlot(Anova)\n```\n\n::: {.cell-output-display}\n![](Chapter_02_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1]  9 12\n```\n\n\n:::\n:::\n\n\n**Interpretación:** El gráfico QQ muestra que los residuos estandarizados del modelo ANOVA se alinean adecuadamente con la línea diagonal, lo que indica que su distribución es aproximadamente normal. La mayoría de los puntos se ubican dentro de la banda de confianza, y no se observan desviaciones sistemáticas. Esta gráfica complementa el resultado del test de Shapiro-Wilk (p = 0.959), confirmando que se cumple el supuesto de normalidad de los residuos en el modelo.\n\n**Homocedasticidad:** Para evaluar el supuesto de homogeneidad de varianzas entre los grupos (homocedasticidad), se aplicará la prueba de Bartlett, la cual es apropiada cuando los datos provienen de poblaciones aproximadamente normales. Esta prueba contrasta la hipótesis nula de igualdad de varianzas frente a la alternativa de varianzas diferentes. El procedimiento se implementa mediante el siguiente script:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbartlett.test(Resultado~Tratamiento, data=DCA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  Resultado by Tratamiento\nBartlett's K-squared = 2.2722, df = 3, p-value = 0.5179\n```\n\n\n:::\n:::\n\n\n**Interpretación:** Dado que el valor de p es mayor que 0.05 (p = 0.5179), no se rechaza la hipótesis nula. Por tanto, se asume que las varianzas entre los tratamientos son homogéneas, cumpliéndose este supuesto clave para el análisis de varianza y para la aplicación de pruebas a posteriori como LSD.\n\n**Pruebas aposteriori** Para identificar diferencias específicas entre las medias de los tratamientos, una vez detectada significancia en el análisis de varianza, se aplicará una prueba de comparaciones múltiples a posteriori. En este caso, se empleará la técnica LSD (Least Significant Difference), que permite realizar comparaciones pareadas entre tratamientos asumiendo homogeneidad de varianzas.\n\nLa implementación de esta prueba requiere la carga del paquete agricolae, utilizando el siguiente script. Instalación si es necesario: install.packages(\"agricolae\"). Carga del paquete: library(agricolae).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(agricolae)\nGrupos <- LSD.test(y = Anova, trt = \"Tratamiento\", group = T, console = T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nStudy: Anova ~ \"Tratamiento\"\n\nLSD t Test for Resultado \n\nMean Square Error:  0.0005953124 \n\nTratamiento,  means and individual ( 95 %) CI\n\n       Resultado        std r         se      LCL      UCL      Min      Max\nArroz   8.733890 0.02192214 4 0.01219951 8.707310 8.760471 8.715318 8.762183\nAvena   8.375414 0.02519485 4 0.01219951 8.348834 8.401995 8.341039 8.395990\nCebada  8.860578 0.03330518 4 0.01219951 8.833998 8.887159 8.822181 8.900695\nMaiz    9.130190 0.01251613 4 0.01219951 9.103609 9.156770 9.113429 9.140539\n            Q25      Q50      Q75\nArroz  8.717232 8.729030 8.745688\nAvena  8.364419 8.382314 8.393309\nCebada 8.842075 8.859719 8.878222\nMaiz   9.124249 9.133395 9.139335\n\nAlpha: 0.05 ; DF Error: 12\nCritical Value of t: 2.178813 \n\nleast Significant Difference: 0.03759044 \n\nTreatments with the same letter are not significantly different.\n\n       Resultado groups\nMaiz    9.130190      a\nCebada  8.860578      b\nArroz   8.733890      c\nAvena   8.375414      d\n```\n\n\n:::\n:::\n\n\n**Intrepretación:** La prueba LSD reveló que los cuatro tratamientos presentan diferencias estadísticamente significativas entre sus medias. El tratamiento Maíz obtuvo el mayor rendimiento promedio, seguido por Cebada, Arroz y Avena, en ese orden descendente.\n\nOtra opcion cuando cambiamos el argumento \"group\" a F(false), se interpreta a mi parecer de forma mas sencilla la diferencia entre las medias.A continuación, se presentan las pruebas de comparaciones múltiples a posteriori aplicadas al modelo de ANOVA ajustado. Se incluyen la prueba LSD, la prueba de Tukey y el test de Scheffé, las cuales permiten identificar diferencias estadísticamente significativas entre los tratamientos evaluados:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGrupos<- LSD.test(y = Anova, trt = \"Tratamiento\", group = F, console = T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nStudy: Anova ~ \"Tratamiento\"\n\nLSD t Test for Resultado \n\nMean Square Error:  0.0005953124 \n\nTratamiento,  means and individual ( 95 %) CI\n\n       Resultado        std r         se      LCL      UCL      Min      Max\nArroz   8.733890 0.02192214 4 0.01219951 8.707310 8.760471 8.715318 8.762183\nAvena   8.375414 0.02519485 4 0.01219951 8.348834 8.401995 8.341039 8.395990\nCebada  8.860578 0.03330518 4 0.01219951 8.833998 8.887159 8.822181 8.900695\nMaiz    9.130190 0.01251613 4 0.01219951 9.103609 9.156770 9.113429 9.140539\n            Q25      Q50      Q75\nArroz  8.717232 8.729030 8.745688\nAvena  8.364419 8.382314 8.393309\nCebada 8.842075 8.859719 8.878222\nMaiz   9.124249 9.133395 9.139335\n\nAlpha: 0.05 ; DF Error: 12\nCritical Value of t: 2.178813 \n\nComparison between treatments means\n\n               difference pvalue signif.        LCL         UCL\nArroz - Avena   0.3584760      0     ***  0.3208855  0.39606642\nArroz - Cebada -0.1266884      0     *** -0.1642788 -0.08909794\nArroz - Maiz   -0.3962994      0     *** -0.4338899 -0.35870901\nAvena - Cebada -0.4851644      0     *** -0.5227548 -0.44757392\nAvena - Maiz   -0.7547754      0     *** -0.7923659 -0.71718499\nCebada - Maiz  -0.2696111      0     *** -0.3072015 -0.23202064\n```\n\n\n:::\n:::\n\n\n**Interpretación:** todas las diferencias entre tratamientos son altamente significativas (p \\< 0.001). Esto confirma que ninguno de los tratamientos comparte una media similar.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTukeyHSD(Anova) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = Resultado ~ Tratamiento, data = DCA)\n\n$Tratamiento\n                   diff         lwr        upr   p adj\nAvena-Arroz  -0.3584760 -0.40969759 -0.3072544 0.0e+00\nCebada-Arroz  0.1266884  0.07546677  0.1779100 4.6e-05\nMaiz-Arroz    0.3962994  0.34507784  0.4475211 0.0e+00\nCebada-Avena  0.4851644  0.43394275  0.5363860 0.0e+00\nMaiz-Avena    0.7547754  0.70355383  0.8059970 0.0e+00\nMaiz-Cebada   0.2696111  0.21838947  0.3208327 0.0e+00\n```\n\n\n:::\n:::\n\n\n**Interpretación:** La prueba de Tukey también confirma diferencias estadísticamente significativas en todas las comparaciones, manteniendo control del error familiar. El gráfico generado muestra intervalos de confianza del 95% que no se solapan, lo que respalda visualmente los resultados.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(TukeyHSD(Anova))\n```\n\n::: {.cell-output-display}\n![](Chapter_02_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n**Interpretación:** El gráfico muestra los intervalos de confianza del 95 % para las diferencias de medias entre los tratamientos, ajustados por comparaciones múltiples (family-wise). Ninguno de los intervalos cruza la línea vertical en cero, lo cual indica que todas las comparaciones entre pares de tratamientos son estadísticamente significativas. La diferencia más grande se observa entre Maíz y Avena, mientras que la más pequeña, aunque significativa, es entre Cebada y Arroz. Este resultado es coherente con los análisis previos (ANOVA, LSD y Scheffé), y respalda que cada tratamiento tiene un efecto significativamente distinto sobre la variable \"Resultado\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscheffe.test(Anova, \"Tratamiento\",console=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nStudy: Anova ~ \"Tratamiento\"\n\nScheffe Test for Resultado \n\nMean Square Error  : 0.0005953124 \n\nTratamiento,  means\n\n       Resultado        std r         se      Min      Max      Q25      Q50\nArroz   8.733890 0.02192214 4 0.01219951 8.715318 8.762183 8.717232 8.729030\nAvena   8.375414 0.02519485 4 0.01219951 8.341039 8.395990 8.364419 8.382314\nCebada  8.860578 0.03330518 4 0.01219951 8.822181 8.900695 8.842075 8.859719\nMaiz    9.130190 0.01251613 4 0.01219951 9.113429 9.140539 9.124249 9.133395\n            Q75\nArroz  8.745688\nAvena  8.393309\nCebada 8.878222\nMaiz   9.139335\n\nAlpha: 0.05 ; DF Error: 12 \nCritical Value of F: 3.490295 \n\nMinimum Significant Difference: 0.05582762 \n\nMeans with the same letter are not significantly different.\n\n       Resultado groups\nMaiz    9.130190      a\nCebada  8.860578      b\nArroz   8.733890      c\nAvena   8.375414      d\n```\n\n\n:::\n:::\n\n\n**Interpretación:** A pesar de ser una prueba más conservadora, el test de Scheffé también encontró diferencias significativas entre todos los tratamientos. El análisis agrupó los tratamientos en distintos niveles.Mínima diferencia significativa (Scheffé): 0.0558. Valor crítico de F: 3.4903\n\n**Conclusión general** Las tres pruebas aplicadas (LSD, Tukey y Scheffé) coinciden en que todos los tratamientos difieren significativamente entre sí. El tratamiento con mayor rendimiento fue Maíz, seguido por Cebada, Arroz y Avena, en orden descendente. Esto respalda la conclusión de que el tipo de tratamiento influye de manera significativa sobre la variable respuesta.\n\n#### 2.2.2 Diseño de bloques completamente al azar OK\n\n#### 2.2.3 Diseño longitudinal (ANOVA de medidas repetidas) OK\n",
    "supporting": [
      "Chapter_02_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}